<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å°ä¸ƒå¿«è·‘</title>
  
  <subtitle>æ²ˆå°ç¥ºæŠ€æœ¯åšå®¢</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://luckyjq.github.io/"/>
  <updated>2019-07-02T13:47:02.261Z</updated>
  <id>https://luckyjq.github.io/</id>
  
  <author>
    <name>LuckyQ</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å®ç°ä¸€ä¸ªç±»ä¼¼vueçš„åŒå‘ç»‘å®š</title>
    <link href="https://luckyjq.github.io/2019/07/02/%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%B1%BB%E4%BC%BCvue%E7%9A%84%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A/"/>
    <id>https://luckyjq.github.io/2019/07/02/å®ç°ä¸€ä¸ªç±»ä¼¼vueçš„åŒå‘ç»‘å®š/</id>
    <published>2019-07-01T16:00:00.000Z</published>
    <updated>2019-07-02T13:47:02.261Z</updated>
    
    <content type="html"><![CDATA[<p>vueç”¨äº†æœ‰æ®µæ—¶é—´äº†ï¼Œå‚è€ƒäº†githubçš„æ–‡ç« ï¼Œå†™äº†ä¸ªç®€åŒ–ç‰ˆ</p><a id="more"></a><p>githubæ–‡ç« é“¾æ¥ï¼š<a href="https://github.com/DMQ/mvvm" target="_blank" rel="noopener">https://github.com/DMQ/mvvm</a><br>å¦‚æœçœ‹ä¸æ‡‚å°±çœ‹æˆ‘çš„å•Šï¼Œå˜¿å˜¿å˜¿</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä½¿ç”¨Vueä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œvueä½œä¸ºä¸€ä¸ªMVVMæ¡†æ¶ï¼Œæœ€æœ‰åçš„å°±æ˜¯åŒå‘ç»‘å®š<br>ä¸€èˆ¬æ¥è¯´å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè§†å›¾å±‚è·Ÿç€å˜åŒ–ï¼Œè¿™æ˜¯å•å‘çš„<br>å½“è§†å›¾å±‚å˜åŒ–æ—¶ï¼Œæ•°æ®ä¹Ÿè·Ÿç€å˜ï¼Œè¿™å°±æ˜¯åŒå‘çš„<br>æ¯”å¦‚åœ¨vueä¸­é€šè¿‡v-modelç»‘å®šçš„è¾“å…¥æ¡†ï¼Œå½“è¾“å…¥æ¡†å†…å€¼å˜åŒ–æ—¶æ•°æ®ä¹Ÿè·Ÿç€å˜åŒ–</p><p>ä»Šå¤©å°±æ¥å®ç°ä¸€ä¸ªç±»ä¼¼äºvueçš„åŒå‘ç»‘å®šï¼Œé¢„æœŸæ•ˆæœï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§†å›¾å±‚</span></span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    <span class="keyword">this</span> is &#123;&#123;name&#125;&#125;, &#123;&#123;age&#125;&#125; years old!</span><br><span class="line">    &lt;h1&gt;</span><br><span class="line">        &#123;&#123;name&#125;&#125;</span><br><span class="line">    &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ•°æ®å±‚</span></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> MVVM(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        name: <span class="string">'jianqi'</span>,</span><br><span class="line">        age: <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Object-definePropertyçš„ä½¿ç”¨"><a href="#Object-definePropertyçš„ä½¿ç”¨" class="headerlink" title="Object.definePropertyçš„ä½¿ç”¨"></a>Object.definePropertyçš„ä½¿ç”¨</h2><p>Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œ å¹¶è¿”å›è¿™ä¸ªå¯¹è±¡ã€‚<br>MDN:<a href="https://dwz.cn/umKlHoaq" target="_blank" rel="noopener">https://dwz.cn/umKlHoaq</a></p><p>å®šä¹‰å¯¹è±¡descriptoræ—¶æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>å±æ€§æè¿°ï¼ˆconfigurableï¼Œenumerableï¼‰ï¼š<br>é€šè¿‡è¿™ä¸ªå®šä¹‰çš„å±æ€§é»˜è®¤ä¸å¯è¢«åˆ é™¤ï¼ˆdelete obj.xxxï¼‰ï¼Œé»˜è®¤ä¸å¯éå†ï¼ˆfor inï¼‰</li><li>å€¼æè¿°ï¼ˆvalueï¼Œ writableï¼‰ï¼š<br>valueå’Œwritableï¼Œvalueé»˜è®¤ä¸ºundefinedï¼Œwritableé»˜è®¤ä¸ºfalseå€¼ä¸èƒ½è¢«æ”¹å˜</li><li>å­˜å–æè¿°ï¼šgetï¼Œsetå‡½æ•°</li><li>å€¼æè¿°ç¬¦å’Œå­˜å–æè¿°ç¬¦ä¸èƒ½åŒæ—¶å­˜åœ¨</li></ol><h2 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h2><p>Subjectæ˜¯ä¸€ä¸ªä¸»é¢˜ï¼ˆç½‘ç«™ï¼‰ã€‚Observerç›¸å½“äºä¸€ä¸ªä¸ªçš„è§‚å¯Ÿè€…ï¼ˆç½‘æ°‘ï¼‰ï¼Œä»–ä»¬å¯ä»¥è®¢é˜…Subjectï¼Œå½“Subjectæ›´æ–°æ—¶é€šçŸ¥Observerï¼Œè§¦å‘Observerä¹‹å‰å®šä¹‰çš„å›è°ƒã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//es6å®ç°</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = <span class="number">0</span></span><br><span class="line">        <span class="keyword">this</span>.observers = []</span><br><span class="line">    &#125;</span><br><span class="line">    getState() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.state</span><br><span class="line">    &#125;</span><br><span class="line">    setState(state)&#123;</span><br><span class="line">        <span class="keyword">this</span>.state = state</span><br><span class="line">        <span class="keyword">this</span>.notifyAllObservers()</span><br><span class="line">    &#125;</span><br><span class="line">    notifyAllObservers()&#123;</span><br><span class="line">        <span class="keyword">this</span>.observers.forEach(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">            observer.update()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    attach(observer) &#123;</span><br><span class="line">        <span class="keyword">this</span>.observers.push(observer)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name, subject)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name</span><br><span class="line">        <span class="keyword">this</span>.subject = subject</span><br><span class="line">        <span class="keyword">this</span>.subject.attach(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    update() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span> update,state:<span class="subst">$&#123;<span class="keyword">this</span>.subject.getState()&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> Subject()</span><br><span class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> Observer(<span class="string">'o'</span>, s)</span><br><span class="line"><span class="keyword">let</span> o2 = <span class="keyword">new</span> Observer(<span class="string">'o2'</span>, s)</span><br><span class="line">s.setState(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h2 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h2><p>é€šè¿‡ä½¿ç”¨Object.definePropertyï¼ˆæ•°æ®æ‹¦æˆªï¼‰å’Œè§‚å¯Ÿè€…æ¨¡å¼å®ç°åŒå‘ç»‘å®š<br>åŸç†å›¾ï¼š</p><ol><li>ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ  ä¸€ä¸ªä¸ªkeyï¼Œæ¯”å¦‚name</li><li>è§‚å¯Ÿè€…æ˜¯ä»€ä¹ˆï¼Ÿ  è§†å›¾é‡Œé¢çš„ï¼Œéœ€è¦è¢«æ›¿æ¢æˆæ•°æ®çš„åœ°æ–¹</li><li>è§‚å¯Ÿè€…ä»€ä¹ˆæ—¶å€™è®¢é˜…ï¼Ÿ<br>ä¸€å¼€å§‹æ‰§è¡ŒMVVMåˆå§‹åŒ–æ—¶å€™æ ¹æ®eléå†domèŠ‚ç‚¹ï¼Œå‘ç°æ—¶å€™æ—¶è®¢é˜…å¯¹åº”ä¸»é¢˜xxxx</li><li>ä¸»é¢˜ä»€ä¹ˆæ—¶å€™é€šçŸ¥æ›´æ–°ï¼Ÿ<br>å½“xxxxæ”¹å˜æ—¶ï¼Œé€šçŸ¥è§‚å¯Ÿè€…æ›´æ–°å†…å®¹ã€‚å¯ä»¥åœ¨ä¸€å¼€å§‹å°±ç›‘æ§dataé€šè¿‡Object.defineProperty()å®ç°</li></ol><h2 id="å®ç°å•å‘æ•°æ®æµï¼ˆæ•°æ®-gt-è§†å›¾ï¼‰"><a href="#å®ç°å•å‘æ•°æ®æµï¼ˆæ•°æ®-gt-è§†å›¾ï¼‰" class="headerlink" title="å®ç°å•å‘æ•°æ®æµï¼ˆæ•°æ®=&gt;è§†å›¾ï¼‰"></a>å®ç°å•å‘æ•°æ®æµï¼ˆæ•°æ®=&gt;è§†å›¾ï¼‰</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// æ€»å…¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MVVM</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(opts)&#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–ï¼Œç»‘å®šæ•°æ®åˆ°vmå¯¹è±¡ä¸Š</span></span><br><span class="line">        <span class="keyword">this</span>.init(opts)</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰dataå€¼ï¼Œè®¾ç½®getå’Œsetæ–¹æ³•</span></span><br><span class="line">        observe(<span class="keyword">this</span>.$data)</span><br><span class="line">        <span class="comment">// éå†domæ ‘ï¼ŒæŸ¥æ‰¾&#123;&#123;&#125;&#125;çš„ç‰¹æ®Šæ ‡è®°</span></span><br><span class="line">        <span class="keyword">this</span>.compile()</span><br><span class="line">    &#125;</span><br><span class="line">    init(opts)&#123;</span><br><span class="line">        <span class="keyword">this</span>.$el = <span class="built_in">document</span>.querySelector(opts.el)</span><br><span class="line">        <span class="keyword">this</span>.$data = opts.data</span><br><span class="line">    &#125;</span><br><span class="line">    compile()&#123;</span><br><span class="line">        <span class="keyword">this</span>.traverse(<span class="keyword">this</span>.$el)</span><br><span class="line">    &#125;</span><br><span class="line">    traverse(node)&#123;</span><br><span class="line">        <span class="keyword">if</span>(node.nodeType === <span class="number">1</span>)&#123;</span><br><span class="line">            node.childNodes.forEach(<span class="function"><span class="params">childNode</span>=&gt;</span>&#123;</span><br><span class="line">                <span class="keyword">this</span>.traverse(childNode)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(node.nodeType === <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">this</span>.renderText(node)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    renderText(node)&#123;</span><br><span class="line">        <span class="keyword">let</span> reg = <span class="regexp">/&#123;&#123;(.+?)&#125;&#125;/g</span></span><br><span class="line">        <span class="keyword">let</span> match</span><br><span class="line">        <span class="keyword">while</span> (match = reg.exec(node.nodeValue))&#123;</span><br><span class="line">            <span class="keyword">let</span> raw = match[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">let</span> key = match[<span class="number">1</span>].trim()</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// åˆå§‹åŒ–æ—¶ç»‘å®šdataé‡Œçš„æ•°æ®åˆ°è§†å›¾å¯¹åº”èŠ‚ç‚¹</span></span><br><span class="line">            node.nodeValue = node.nodeValue.replace(raw, <span class="keyword">this</span>.$data[key])</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¯¹å½“å‰çš„keyè®¾ç½®ç›‘å¬</span></span><br><span class="line">            <span class="keyword">new</span> Observer(<span class="keyword">this</span>, key, <span class="function"><span class="keyword">function</span> (<span class="params">val, oldVal</span>) </span>&#123;</span><br><span class="line">                node.nodeValue = node.nodeValue.replace(oldVal, val)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> currentObserver = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†dataï¼Œæ·»åŠ ç›‘å¬çš„observeæ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">observe</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!data || <span class="keyword">typeof</span> data !== <span class="string">'object'</span>) <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¦‚æœä¸‹é¢çš„getæ–¹æ³•ç›´æ¥è¿”å›data[key]ä¼šå¼•èµ·å¾ªç¯è°ƒç”¨å¯¼è‡´æ ˆæº¢å‡º</span></span><br><span class="line">        <span class="keyword">let</span> val = data[key]</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ¯ä¸€ä¸ªkeyéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„subject</span></span><br><span class="line">        <span class="keyword">let</span> subject = <span class="keyword">new</span> Subject()</span><br><span class="line">        <span class="built_in">Object</span>.defineProperty(data, key, &#123;</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">get</span>: function () &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'run get'</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// currentObserveræ˜¯ä¸€ä¸ªå…¨å±€çš„å¯¹è±¡</span></span><br><span class="line">                <span class="keyword">if</span>(currentObserver)&#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// è®¢é˜…æŸä¸€ä¸ªsubjectï¼ˆdataä¸­çš„æŸä¸€ä¸ªé”®å€¼å¯¹çš„keyï¼‰</span></span><br><span class="line">                    currentObserver.subscribeTo(subject)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> val</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>: function (newVal) &#123;</span><br><span class="line">                val = newVal</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'run set'</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// æ›´æ”¹äº†å€¼ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…</span></span><br><span class="line">                subject.notify()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">typeof</span> val === <span class="string">'object'</span>)&#123;</span><br><span class="line">            observe(val)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸»é¢˜Subjectï¼Œdataä¸­çš„æ¯ä¸€ä¸ªkeyéƒ½æ˜¯ä¸€ä¸ªsubject</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Subject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="comment">// ä¸€ä¸ªä¸»é¢˜ä¼šæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œæ¯”å¦‚è¯´åœ¨è§†å›¾ä¸­ä¼šæœ‰å¤šä¸ªåœ°æ–¹æœ‰&#123;&#123;name&#125;&#125;</span></span><br><span class="line">        <span class="keyword">this</span>.observers = []</span><br><span class="line">    &#125;</span><br><span class="line">    addObserver(observer)&#123;</span><br><span class="line">        <span class="keyword">this</span>.observers.push(observer)</span><br><span class="line">    &#125;</span><br><span class="line">    notify()&#123;</span><br><span class="line">        <span class="keyword">this</span>.observers.forEach(<span class="function"><span class="params">observer</span>=&gt;</span>&#123;</span><br><span class="line">            observer.update()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¢é˜…è€…Observer</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(vm, key, cb)&#123;</span><br><span class="line">        <span class="keyword">this</span>.vm = vm</span><br><span class="line">        <span class="keyword">this</span>.key = key</span><br><span class="line">        <span class="keyword">this</span>.cb = cb</span><br><span class="line">        <span class="keyword">this</span>.value = <span class="keyword">this</span>.getValue()</span><br><span class="line">    &#125;</span><br><span class="line">    update()&#123;</span><br><span class="line">        <span class="keyword">let</span> oldVal = <span class="keyword">this</span>.value</span><br><span class="line">        <span class="keyword">let</span> value = <span class="keyword">this</span>.getValue()</span><br><span class="line">        <span class="keyword">if</span>(value !== oldVal)&#123;</span><br><span class="line">            <span class="keyword">this</span>.value = value</span><br><span class="line">            <span class="keyword">this</span>.cb.bind(<span class="keyword">this</span>.vm)(value, oldVal)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    subscribeTo(subject)&#123;</span><br><span class="line">        subject.addObserver(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    getValue()&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// currentObserveræ˜¯ä¸€ä¸ªå…¨å±€çš„å˜é‡ï¼Œè®¾ç½®ä»–æœ‰å€¼</span></span><br><span class="line">    <span class="comment">// å¹¶æ‰§è¡Œä¸‹ä¸€è¡Œè§¦å‘getæ–¹æ³•ï¼Œä¼šè¿è¡Œobserveæ–¹æ³•ä¸­çš„è®¢é˜…æ“ä½œ</span></span><br><span class="line">    <span class="comment">// currentObserver.subscribeTo(subject)</span></span><br><span class="line">        currentObserver = <span class="keyword">this</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿™é‡Œä¼šè§¦å‘dataä¸­å…ƒç´ çš„getå‡½æ•°</span></span><br><span class="line">        <span class="keyword">let</span> value = <span class="keyword">this</span>.vm.$data[<span class="keyword">this</span>.key]</span><br><span class="line">        currentObserver = <span class="literal">null</span></span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// è°ƒç”¨</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    this is &#123;&#123;name&#125;&#125;, &#123;&#123;age&#125;&#125; years old!</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> MVVM(&#123;</span></span><br><span class="line"><span class="javascript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"><span class="javascript">            name: <span class="string">'jianqi'</span>,</span></span><br><span class="line">            age: 3</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="å®ç°åŒå‘ç»‘å®š"><a href="#å®ç°åŒå‘ç»‘å®š" class="headerlink" title="å®ç°åŒå‘ç»‘å®š"></a>å®ç°åŒå‘ç»‘å®š</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;vueç”¨äº†æœ‰æ®µæ—¶é—´äº†ï¼Œå‚è€ƒäº†githubçš„æ–‡ç« ï¼Œå†™äº†ä¸ªç®€åŒ–ç‰ˆ&lt;/p&gt;
    
    </summary>
    
      <category term="æ¡†æ¶" scheme="https://luckyjq.github.io/categories/%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="vue" scheme="https://luckyjq.github.io/tags/vue/"/>
    
      <category term="æºç " scheme="https://luckyjq.github.io/tags/%E6%BA%90%E7%A0%81/"/>
    
  </entry>
  
  <entry>
    <title>koa2å…¥é—¨</title>
    <link href="https://luckyjq.github.io/2019/06/29/koa2%E5%85%A5%E9%97%A8/"/>
    <id>https://luckyjq.github.io/2019/06/29/koa2å…¥é—¨/</id>
    <published>2019-06-28T16:00:00.000Z</published>
    <updated>2019-07-02T13:46:13.184Z</updated>
    
    <content type="html"><![CDATA[<p>å¤§æ‚çƒ©ï¼Œè®°å½•è´´ã€‚åŒ…å«ä¸€ä¸ªç®€ç‰ˆkoaæ¡†æ¶çš„æ ¸å¿ƒå®ç°</p><a id="more"></a><h2 id="å‰ç½®çŸ¥è¯†ï¼šå…³äºasyncå’Œawaitçš„ç†è§£"><a href="#å‰ç½®çŸ¥è¯†ï¼šå…³äºasyncå’Œawaitçš„ç†è§£" class="headerlink" title="å‰ç½®çŸ¥è¯†ï¼šå…³äºasyncå’Œawaitçš„ç†è§£"></a>å‰ç½®çŸ¥è¯†ï¼šå…³äºasyncå’Œawaitçš„ç†è§£</h2><p><a href="https://segmentfault.com/a/1190000007535316" target="_blank" rel="noopener">https://segmentfault.com/a/1190000007535316</a></p><ul><li>awaitå¿…é¡»åŒ…è£¹åœ¨asyncå‡½æ•°é‡Œ</li><li>asyncå‡½æ•°æ‰§è¡Œè¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡</li><li>awaitåœ¨ç­‰ä»€ä¹ˆï¼Ÿç­‰ä¸€ä¸ªpromiseï¼Œè·å–ä»–çš„resolveçš„å€¼</li><li>å¦‚æœawaitåé¢çš„promiseè¿”å›çš„æ˜¯rejectçš„å€¼ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨tryï¼Œcatchè¿›è¡ŒåŒ…è£¹</li></ul><h2 id="koa2åŸç†ï¼ˆuseå’Œnextï¼‰"><a href="#koa2åŸç†ï¼ˆuseå’Œnextï¼‰" class="headerlink" title="koa2åŸç†ï¼ˆuseå’Œnextï¼‰"></a>koa2åŸç†ï¼ˆuseå’Œnextï¼‰</h2><p>æºç è§£è¯»ï¼š<a href="https://zhuanlan.zhihu.com/p/34797505" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/34797505</a></p><p>è‡ªå·±å®ç°ä¸€ä¸ªç®€ç‰ˆ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»„åˆä¸­é—´ä»¶</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compose</span>(<span class="params">middlewareList</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//dispatchå‡½æ•°ç”¨äºæ‰§è¡Œä¸€ä¸ªä¸­é—´ä»¶</span></span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">dispatch</span>(<span class="params">i</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> fn = middlewareList[i]</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve(</span><br><span class="line"></span><br><span class="line">                <span class="comment">//è¿™é‡Œfnçš„ç¬¬äºŒä¸ªå‚æ•°å°±ç›¸å½“äºnext</span></span><br><span class="line">                fn(ctx, dispatch.bind(<span class="literal">null</span>, i + <span class="number">1</span>))  <span class="comment">// promise</span></span><br><span class="line">            )</span><br><span class="line">            &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dispatch(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LikeKoa2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.middlewareList = []</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    use(fn) &#123;</span><br><span class="line">        <span class="keyword">this</span>.middlewareList.push(fn)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    createContext(req, res) &#123;</span><br><span class="line">        <span class="keyword">const</span> ctx = &#123;</span><br><span class="line">            req,</span><br><span class="line">            res</span><br><span class="line">        &#125;</span><br><span class="line">        ctx.query = req.query</span><br><span class="line">        <span class="keyword">return</span> ctx</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleRequest(ctx, fn) &#123;</span><br><span class="line">        <span class="keyword">return</span> fn(ctx)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    callback() &#123;</span><br><span class="line">        <span class="keyword">const</span> fn = compose(<span class="keyword">this</span>.middlewareList)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> ctx = <span class="keyword">this</span>.createContext(req, res)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.handleRequest(ctx, fn)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    listen(...args) &#123;</span><br><span class="line">        <span class="keyword">const</span> server = http.createServer(<span class="keyword">this</span>.callback())</span><br><span class="line">        server.listen(...args)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = LikeKoa2</span><br></pre></td></tr></table></figure><h2 id="koa2çš„ctxå¯¹è±¡"><a href="#koa2çš„ctxå¯¹è±¡" class="headerlink" title="koa2çš„ctxå¯¹è±¡"></a>koa2çš„ctxå¯¹è±¡</h2><p>koa2çš„ctxå°è£…äº†reqå’Œresï¼Œå¯ä»¥é€šè¿‡ctxç›´æ¥å–å¾—ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ctx.request.xxçš„å½¢å¼å–å¾—<br>å¸¸ç”¨çš„ï¼š</p><ul><li>ctx.params</li><li>ctx.request.query</li><li>ctx.request.header</li><li>ctx.request.body( éœ€è¦ä½¿ç”¨body-parseræ’ä»¶)</li></ul><h2 id="åˆ©ç”¨cookieå’Œsessionè¿›è¡Œé‰´æƒ"><a href="#åˆ©ç”¨cookieå’Œsessionè¿›è¡Œé‰´æƒ" class="headerlink" title="åˆ©ç”¨cookieå’Œsessionè¿›è¡Œé‰´æƒ"></a>åˆ©ç”¨cookieå’Œsessionè¿›è¡Œé‰´æƒ</h2><p>ä½œä¸ºä¸€ä¸ªç½‘ç«™æœ‰äº›èµ„æºéœ€è¦ç™»é™†æ‰èƒ½è®¿é—®ï¼Œæœ‰äº›ä¸ç™»é™†ä¹Ÿå¯ä»¥æµè§ˆã€‚<br>å¦‚ä½•å®ç°é‰´æƒï¼Ÿå¸¸ç”¨çš„æ–¹æ³•æ˜¯cookieå’Œsession</p><p>è¿™é‡Œå‡è®¾sessionå­˜å‚¨åœ¨æœåŠ¡ç«¯å†…å­˜ä¸­ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„SESSION[ ]</p><ol><li>ç”¨æˆ·è®¿é—®æŸä¸ªurlæ—¶ï¼Œè¿›è¡Œç”¨æˆ·é‰´æƒï¼Œæœ‰æ— cookie</li><li>æ²¡æœ‰cookieï¼Œå“åº”è®¾ç½®cookie,æ¯”å¦‚userid: xxx01ï¼Œåœ¨æœåŠ¡ç«¯SESSION[ ]ä¸­æ·»åŠ ä¸€ä¸ªsession{xxx01:{ }}</li><li>ç”¨æˆ·ç™»é™†ï¼Œå¾€SESSIONä¸­å¯¹åº”çš„sessionå¯¹è±¡ä¸­å†™å­—æ®µï¼Œæ¯”å¦‚username: xxxã€‚æ­¤æ—¶SESSONæ•°ç»„ä¸­æœ‰ä¸€ä¸ªsessionåº”è¯¥æ˜¯è¿™æ ·çš„ï¼šssession{xxx01:{username: xxx}}</li><li>è¯·æ±‚æ—¶æºå¸¦cookieï¼ŒæœåŠ¡ç«¯è·å–useridå»SESSIONä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œçœ‹usernameæ˜¯å¦æœ‰å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ç™»é™†äº†</li></ol><p>æ³¨æ„äº‹é¡¹ï¼š</p><ol><li>è®¾ç½® cookieæ—¶åº”å½“è®¾ç½®è¿‡æœŸæ—¶é—´</li><li>sessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­é‡å¯å°±æ²¡äº†ï¼Œéœ€è¦è¿›è¡ŒæŒä¹…åŒ–ã€‚å¯ä»¥è€ƒè™‘å­˜åœ¨redisä¸­æˆ–è€…ç›´æ¥åŠ å¯†åè¿”å›åˆ°cookieä¹Ÿå¯ä»¥</li></ol><h2 id="koa2å¸¸ç”¨æ’ä»¶"><a href="#koa2å¸¸ç”¨æ’ä»¶" class="headerlink" title="koa2å¸¸ç”¨æ’ä»¶"></a>koa2å¸¸ç”¨æ’ä»¶</h2><h3 id="ç™»é™†é‰´æƒç›¸å…³"><a href="#ç™»é™†é‰´æƒç›¸å…³" class="headerlink" title="ç™»é™†é‰´æƒç›¸å…³"></a>ç™»é™†é‰´æƒç›¸å…³</h3><ol><li><p>koa-sessionï¼ˆæŠŠsessionåŠ å¯†åå­˜åœ¨cookieä¸­ï¼Œæ”¯æŒå¤–éƒ¨æ•°æ®åº“ï¼‰<br>æºç è§£è¯»æ–‡ç« ï¼š<a href="https://segmentfault.com/a/1190000012412299" target="_blank" rel="noopener">https://segmentfault.com/a/1190000012412299</a></p></li><li><p>koa-generic-sessionï¼Œkoa-redisï¼ˆè¿™ä¸¤ä¸ªé…å¥—å¯ä»¥å­˜å‚¨sessionåˆ°redisï¼‰</p></li></ol><h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><h3 id="jsä¸­try-catchåªèƒ½æ•æ‰åŒæ­¥é”™è¯¯"><a href="#jsä¸­try-catchåªèƒ½æ•æ‰åŒæ­¥é”™è¯¯" class="headerlink" title="jsä¸­try catchåªèƒ½æ•æ‰åŒæ­¥é”™è¯¯"></a>jsä¸­try catchåªèƒ½æ•æ‰åŒæ­¥é”™è¯¯</h3><p>å¼‚æ­¥ä»£ç çš„é”™è¯¯å¾ˆéš¾ï¼Œé€šè¿‡ä½¿ç”¨promiseå’Œasyncå’Œawaitå¯ä»¥ç®€åŒ–å¼‚æ­¥çš„é”™è¯¯å¤„ç†ï¼Œä½¿ç”¨tryå’Œcatch<br>ä¸‹é¢è¿™æ ·ä¹Ÿæ˜¯æ²¡ç”¨çš„ï¼Œå¿…é¡»è¿”å›å¼‚æ­¥å‡½æ•°çš„promiseåŒ…è£…</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/c25a5034d64bde05d67f38042b401d57.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>è¿™æ ·æ‰å¯¹</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/3cd5daadf1e308d2427851ebe6d8a691.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><h3 id="AOPæ€æƒ³"><a href="#AOPæ€æƒ³" class="headerlink" title="AOPæ€æƒ³"></a>AOPæ€æƒ³</h3><p>è‡ªå®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œæœ€å…ˆæ³¨å†Œï¼Œtry next()å³å¯ï¼Œç›¸å½“äºè°ƒç”¨é“¾æ¡</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/74e4ca944f57360564990c5ffc36c401.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><h3 id="å°è£…é”™è¯¯å¯¹è±¡"><a href="#å°è£…é”™è¯¯å¯¹è±¡" class="headerlink" title="å°è£…é”™è¯¯å¯¹è±¡"></a>å°è£…é”™è¯¯å¯¹è±¡</h3><p>çŠ¶æ€ç <br>error code<br>error message<br>request url</p><p>ä¸€ä¸ªä½œä¸šé¢˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">this</span>.nameA = <span class="string">'a'</span></span><br><span class="line">        <span class="keyword">this</span>.nameD = <span class="string">'d'</span></span><br><span class="line">    &#125;</span><br><span class="line">    validateA() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"A"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.nameB = <span class="string">'b'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    validateB() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"B"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> B()</span><br><span class="line"><span class="comment">// ç¼–å†™ä¸€ä¸ªå‡½æ•°findMembers,è·å–bçš„æ‰€æœ‰å¸¦å‰ç¼€çš„å±æ€§å’Œæ–¹æ³•</span></span><br><span class="line"><span class="keyword">const</span> members = findMembers2(b, <span class="string">'name'</span>, <span class="string">'validate'</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¤§æ‚çƒ©ï¼Œè®°å½•è´´ã€‚åŒ…å«ä¸€ä¸ªç®€ç‰ˆkoaæ¡†æ¶çš„æ ¸å¿ƒå®ç°&lt;/p&gt;
    
    </summary>
    
      <category term="æ¡†æ¶" scheme="https://luckyjq.github.io/categories/%E6%A1%86%E6%9E%B6/"/>
    
    
      <category term="nodejs" scheme="https://luckyjq.github.io/tags/nodejs/"/>
    
      <category term="koa2" scheme="https://luckyjq.github.io/tags/koa2/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ä¸ƒç‰›äº‘ä¸€é”®ä¸Šä¼ åšå®¢å›¾ç‰‡ï¼ˆmacï¼‰</title>
    <link href="https://luckyjq.github.io/2019/06/24/%E4%BD%BF%E7%94%A8%E4%B8%83%E7%89%9B%E4%BA%91%E4%B8%80%E9%94%AE%E4%B8%8A%E4%BC%A0%E5%8D%9A%E5%AE%A2%E5%9B%BE%E7%89%87%EF%BC%88mac)/"/>
    <id>https://luckyjq.github.io/2019/06/24/ä½¿ç”¨ä¸ƒç‰›äº‘ä¸€é”®ä¸Šä¼ åšå®¢å›¾ç‰‡ï¼ˆmac)/</id>
    <published>2019-06-23T16:00:00.000Z</published>
    <updated>2019-07-02T13:40:13.875Z</updated>
    
    <content type="html"><![CDATA[<p>å˜€ï½å°å§å§ç§’ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘å•¦ï¼</p><p>å†™åšå®¢çš„æ•ˆç‡åˆæå‡äº†ï¼</p><a id="more"></a><h2 id="éšä¾¿BB"><a href="#éšä¾¿BB" class="headerlink" title="éšä¾¿BB"></a>éšä¾¿BB</h2><p>hexoçš„åšå®¢å¾ˆæ—©ä¹‹å‰å°±æ­å»ºäº†ï¼Œé›¶é›¶æ•£æ•£å†™è¿‡å‡ ç¯‡æ–‡ç« ã€‚<br>ç°åœ¨å¤§å­¦ç”Ÿæ´»ä¹Ÿç»“æŸäº†ï¼Œå³å°†æ­¥å…¥ç ”ç©¶ç”Ÿï¼Œæ‰“ç®—å¥½å¥½åˆ©ç”¨è¿™ä¸ªæš‘å‡ã€‚<br>é‡æ–°æ‹¾èµ·åšå®¢ï¼Œå½“ä½œä¸€ä¸ªè®°å½•çš„å°åœ°æ–¹ã€‚</p><p>ä¹‹å‰æˆ‘å¾ˆè®¨åŒåœ¨hexoä¸Šå†™åšå®¢ï¼Œå› ä¸ºå›¾ç‰‡é…ç½®æ˜¯åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œé¦–å…ˆå¾—å‡†å¤‡å¥½åšå®¢çš„ç…§ç‰‡ï¼Œç„¶åä¸Šä¼ åˆ°æŸä¸€ä¸ªå›¾ä¼ ï¼Œå†æ‹¿åˆ°å›¾ç‰‡åœ°å€æŒ‰ç…§ç‰¹å®šæ ¼å¼æ’å…¥æ–‡ç« ã€‚è¿™å€’ä¹Ÿè¿˜å¥½ï¼Œå…³é”®æ˜¯é‚£äº›å…è´¹å›¾åºŠè€æ˜¯å®¹æ˜“æŒ‚ã€‚ã€‚ã€‚å¥½ä¸å®¹æ˜“ç”³è¯·äº†ä¸ƒç‰›äº‘ï¼Œç«Ÿç„¶éœ€è¦ç»™ç©ºé—´ç»‘å®šåŸŸåï¼Œæµ‹è¯•åŸŸååªèƒ½ç”¨ä¸€ä¸ªæœˆï¼Œè›‹ç–¼ã€‚</p><p>ç»ˆäºã€‚ã€‚æˆ‘ç”³è¯·å¥½äº†ç‹¬ç«‹åŸŸåï¼Œé€šè¿‡äº†å¤‡æ¡ˆï¼Œæœ‰äº†è¶³å¤Ÿçš„æ—¶é—´å’Œçƒ­æƒ…ã€‚ã€‚æˆ‘åˆå›å‘äº†ã€‚</p><h2 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h2><p>Alfredæ˜¯ä¸ªä»€ä¹ˆæˆ‘ä¹Ÿæ²¡ä»”ç»†ç ”ç©¶ï¼Œå¤§æ¦‚å°±æ˜¯ä¸€ä¸ªæ•ˆç‡å·¥å…·ï¼Œæœ€ğŸ‚çš„åœ°æ–¹æ˜¯å®ƒæ”¯æŒè‡ªå®šä¹‰è„šæœ¬ï¼Œç„¶åå®ç°è‡ªåŠ¨åŒ–æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å°±æ˜¯è¦åˆ©ç”¨è¿™ä¸ªå·¥å…·å’Œä¸ƒç‰›çš„å¼€æ”¾SDKå®Œæˆä¸€ä¸ªè‡ªåŠ¨åŒ–æ“ä½œã€‚</p><p>å½“ç„¶ã€‚ã€‚æœ‰äººå·²ç»å†™å¥½äº†è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬äº†<br>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/jiwenxing/qimage-mac" target="_blank" rel="noopener">https://github.com/jiwenxing/qimage-mac</a></p><h2 id="æ­£å¼å¼€å¹²"><a href="#æ­£å¼å¼€å¹²" class="headerlink" title="æ­£å¼å¼€å¹²"></a>æ­£å¼å¼€å¹²</h2><h3 id="1-ä¸‹è½½Alfredï¼Œéœ€è¦ä½¿ç”¨ä»–çš„æ”¶è´¹åŠŸèƒ½ï¼Œä¸‹é¢ä¼šç»™å‡ºç ´è§£ç‰ˆã€‚"><a href="#1-ä¸‹è½½Alfredï¼Œéœ€è¦ä½¿ç”¨ä»–çš„æ”¶è´¹åŠŸèƒ½ï¼Œä¸‹é¢ä¼šç»™å‡ºç ´è§£ç‰ˆã€‚" class="headerlink" title="1.ä¸‹è½½Alfredï¼Œéœ€è¦ä½¿ç”¨ä»–çš„æ”¶è´¹åŠŸèƒ½ï¼Œä¸‹é¢ä¼šç»™å‡ºç ´è§£ç‰ˆã€‚"></a>1.ä¸‹è½½Alfredï¼Œéœ€è¦ä½¿ç”¨ä»–çš„æ”¶è´¹åŠŸèƒ½ï¼Œä¸‹é¢ä¼šç»™å‡ºç ´è§£ç‰ˆã€‚</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://pan.baidu.com/s/1mir5F6K" target="_blank" rel="noopener">https://pan.baidu.com/s/1mir5F6K</a><br>æå–ç ï¼šjj7s</p><h3 id="2-å®‰è£…ä¸ƒç‰›äº‘çš„SDKå·¥å…·"><a href="#2-å®‰è£…ä¸ƒç‰›äº‘çš„SDKå·¥å…·" class="headerlink" title="2.å®‰è£…ä¸ƒç‰›äº‘çš„SDKå·¥å…·"></a>2.å®‰è£…ä¸ƒç‰›äº‘çš„SDKå·¥å…·</h3><p>ä¸‹è½½åœ°å€ï¼š<a href="https://developer.qiniu.com/kodo/tools/1302/qshell" target="_blank" rel="noopener">https://developer.qiniu.com/kodo/tools/1302/qshell</a><br>ä¸‹è½½å®Œåè§£å‹ï¼ŒæŠŠqshell_darwin_amd64æ–‡ä»¶é‡å‘½åä¸ºqshellå¹¶ç§»è‡³usr/local/binç›®å½•ä¸‹å³å¯ã€‚åé¢çš„è„šæœ¬ä¼šå¼•ç”¨è¿™ä¸ªSDKã€‚</p><h3 id="3-æ³¨å†Œä¸ƒç‰›äº‘è´¦å·å¹¶å®åè®¤è¯"><a href="#3-æ³¨å†Œä¸ƒç‰›äº‘è´¦å·å¹¶å®åè®¤è¯" class="headerlink" title="3.æ³¨å†Œä¸ƒç‰›äº‘è´¦å·å¹¶å®åè®¤è¯"></a>3.æ³¨å†Œä¸ƒç‰›äº‘è´¦å·å¹¶å®åè®¤è¯</h3><p>è‡ªå·±å»æ³¨å†Œã€‚æœ€å¥½å†å‡†å¤‡ä¸€ä¸ªç‹¬ç«‹åŸŸåï¼Œå› ä¸ºä¸ƒç‰›çš„æµ‹è¯•åŸŸåæœ‰æ•ˆæœŸåªæœ‰ä¸€ä¸ªæœˆã€‚</p><h3 id="4-ä¸‹è½½githubè„šæœ¬ï¼Œè¿è¡Œqimage-alfredworkflow"><a href="#4-ä¸‹è½½githubè„šæœ¬ï¼Œè¿è¡Œqimage-alfredworkflow" class="headerlink" title="4.ä¸‹è½½githubè„šæœ¬ï¼Œè¿è¡Œqimage.alfredworkflow"></a>4.ä¸‹è½½githubè„šæœ¬ï¼Œè¿è¡Œ<em>qimage.alfredworkflow</em></h3><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/0c049de0deb969fed678f02706238fc0.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>ä¿®æ”¹ä¸­é—´çš„ <em>Run Script</em>ï¼Œå…·ä½“æ“ä½œè§ä¸‹é¢é“¾æ¥ã€‚<br><a href="https://github.com/jiwenxing/qimage-mac/issues/16" target="_blank" rel="noopener">https://github.com/jiwenxing/qimage-mac/issues/16</a></p><p>ä¿®æ”¹<em>Hotkey</em>è¿›è¡Œè‡ªåŠ¨åŒ–è§¦å‘å¿«æ·é”®è®¾ç½®ï¼Œæ¨ècmd+option+vã€‚</p><p>ç°åœ¨ä½ å¯ä»¥è¯•ä¸€è¯•äº†ï¼Œcmd+cå¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ°å‰ªåˆ‡æ¿ï¼Œåœ¨mdæ–‡ä»¶é‡Œcmd+option+v<br>ğŸ˜¯ ä»–è¿”å›äº†mdçš„å›¾ç‰‡å¼•ç”¨æ ¼å¼ï¼Œå†™åšå®¢æ•ˆç‡åˆæå‡äº†å‘¢ï¼</p><p>å½“ç„¶ä½ å¯èƒ½ä¼šéœ€è¦ä¸€äº›å®šåˆ¶åŒ–çš„å°å˜åŒ–ï¼Œè¿™æ—¶å€™ä½ å°±è¦ç¨å¾®è¯»ä¸€ä¸‹è„šæœ¬ç„¶åè¿›è¡Œä¿®æ”¹äº†ã€‚</p><p>ä¼ ä¸ªå°å§å§è¯•è¯•æ°´ï¼</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/21f8dcd2336c6dcc3e38938e769b75da.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>å–‚ï¼å°å¦¹å¦¹ï¼ä½ è·Ÿè°æ’’å¨‡å‘¢ï¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å˜€ï½å°å§å§ç§’ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘å•¦ï¼&lt;/p&gt;
&lt;p&gt;å†™åšå®¢çš„æ•ˆç‡åˆæå‡äº†ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="å·¥å…·" scheme="https://luckyjq.github.io/categories/%E5%B7%A5%E5%85%B7/"/>
    
    
      <category term="å·¥å…·" scheme="https://luckyjq.github.io/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="éªšæ“ä½œ" scheme="https://luckyjq.github.io/tags/%E9%AA%9A%E6%93%8D%E4%BD%9C/"/>
    
  </entry>
  
  <entry>
    <title>æµè§ˆå™¨å’Œnodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶</title>
    <link href="https://luckyjq.github.io/2019/04/21/%E6%B5%8F%E8%A7%88%E5%99%A8%E5%92%8Cnodejs%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF%E6%9C%BA%E5%88%B6/"/>
    <id>https://luckyjq.github.io/2019/04/21/æµè§ˆå™¨å’Œnodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶/</id>
    <published>2019-04-20T16:00:00.000Z</published>
    <updated>2019-07-02T13:45:32.369Z</updated>
    
    <content type="html"><![CDATA[<p>äº‹ä»¶å¾ªç¯ï¼Œç”»ä¸ªåœˆåœˆâ€¦â€¦</p><a id="more"></a><h2 id="æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶"><a href="#æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶" class="headerlink" title="æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶"></a>æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶</h2><p>æµè§ˆå™¨äº‹ä»¶å¾ªç¯å›¾ï¼ˆæ‘˜è‡ªã€Šjavascriptå¿è€…ç§˜ç±ç¬¬äºŒç‰ˆã€‹13ç« ï¼‰ï¼š</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/1e7b48b68e4388149a47ecdb57761ba0.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><h3 id="å®ä»»åŠ¡å¾®ä»»åŠ¡"><a href="#å®ä»»åŠ¡å¾®ä»»åŠ¡" class="headerlink" title="å®ä»»åŠ¡å¾®ä»»åŠ¡"></a>å®ä»»åŠ¡å¾®ä»»åŠ¡</h3><p><strong>å®ä»»åŠ¡ï¼šä»æµè§ˆå™¨è§’åº¦ï¼Œä»£è¡¨ä¸€ä¸ªç¦»æ•£çš„ï¼Œç‹¬ç«‹çš„å·¥ä½œå•å…ƒ</strong><br>æ¯”å¦‚ï¼šåˆ›å»ºä¸»æ–‡æ¡£å¯¹è±¡ï¼Œè§£æHTMLï¼Œæ‰§è¡Œä¸»çº¿ï¼ˆå…¨å±€ï¼‰jsä»£ç <br>æ›´æ”¹å½“å‰URLå’Œå„ç§äº‹ä»¶ï¼ˆé¡µé¢åŠ è½½ï¼Œç½‘ç»œäº‹ä»¶ï¼Œå®šæ—¶å™¨ç­‰ï¼‰</p><p><strong>å¾®ä»»åŠ¡ï¼šæ˜¯æ›´å°çš„ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡è¦å°½å¯èƒ½å¿«çš„ï¼Œé€šè¿‡å¼‚æ­¥æ–¹å¼æ‰§è¡Œ</strong><br>æ¯”å¦‚ï¼šDOMå˜åŒ–ï¼ˆMutationObserverï¼‰ï¼ŒPromiseå›è°ƒå‡½æ•°<br>ç”±äºå› ä¸ºasync await æœ¬èº«å°±æ˜¯promise+generatorçš„è¯­æ³•ç³–ï¼Œæ‰€ä»¥awaitåé¢çš„ä¹Ÿæ˜¯</p><h3 id="ä»é¢è¯•é¢˜ç†è§£è¿è¡Œæœºåˆ¶"><a href="#ä»é¢è¯•é¢˜ç†è§£è¿è¡Œæœºåˆ¶" class="headerlink" title="ä»é¢è¯•é¢˜ç†è§£è¿è¡Œæœºåˆ¶"></a>ä»é¢è¯•é¢˜ç†è§£è¿è¡Œæœºåˆ¶</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å†™å‡ºè¾“å‡º</span></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">    resolve(<span class="number">3</span>)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">val</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(val);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æ‰§è¡Œç»“æœä¸ºï¼š2ï¼Œ4ï¼Œ3ï¼Œ1<br>æˆ‘ä»¬ç»“åˆä¸Šé¢çš„äº‹ä»¶å¾ªç¯å›¾æ¥ç†è§£ä¸‹è¾“å‡ºç»“æœ</p><ol><li>é¦–å…ˆæ‰§è¡Œä¸»çº¿ï¼ˆå…¨å±€jsä»£ç ï¼‰ï¼Œç¢°åˆ°å®šæ—¶å™¨ä»£ç ï¼Œå®šæ—¶å™¨æ—¶é—´ä¸º0è¡¨ç¤ºå°½å¿«æ‰§è¡Œ<br>å®šæ—¶å™¨æ˜¯å®ä»»åŠ¡ï¼Œäºæ˜¯æŠŠå®šæ—¶å™¨ä»»åŠ¡æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—<br>ç°åœ¨å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯ï¼ˆä¸»çº¿ï¼Œå®šæ—¶å™¨ï¼‰</li><li>æ¥ç€å¾€ä¸‹è§£æï¼Œå¼€å§‹æ‰§è¡Œpromiseçš„ä»£ç ï¼Œé‡åˆ°promiseé‡Œçš„2ç›´æ¥è¾“å‡º</li><li>promiseä¸­æœ‰ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œæ˜¯å¾®ä»»åŠ¡ï¼Œäºæ˜¯æŠŠä»–æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—</li><li>ç»§ç»­å¾€ä¸‹æ‰§è¡Œå…¨å±€ä»£ç ï¼Œè¾“å‡º4</li><li>è·‘å®Œä¸Šé¢çš„æµç¨‹ï¼Œjsä¸»çº¿ï¼ˆå…¨å±€ï¼‰ä»£ç æ‰§è¡Œå®Œæˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œæˆäº†</li><li>æŒ‰ç…§äº‹ä»¶å¾ªç¯å›¾çš„æµç¨‹ï¼Œå¼€å§‹æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œæœ‰çš„è¯æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œè¾“å‡º3</li><li>ç¬¬ä¸€è½®å¾ªç¯ç»“æŸï¼Œæ›´æ–°UIä¸»çº¿ï¼ˆå…¨å±€ï¼‰ä»»åŠ¡ä»å®ä»»åŠ¡ä¸­å‡ºé˜Ÿ</li><li>å¼€å§‹æ–°çš„ä¸€è½®äº‹ä»¶å¾ªç¯ï¼Œæ‰§è¡Œé˜Ÿé¦–çš„å®ä»»åŠ¡å³ä¹‹å‰çš„å®šæ—¶å™¨ä»»åŠ¡è¾“å‡º1</li></ol><p>é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œå®šæ—¶å™¨çš„æ‰§è¡Œæ—¶é—´æœºåˆ¶ï¼š<br>å› ä¸ºjså•çº¿ç¨‹çš„æœ¬è´¨ï¼Œ<strong>æˆ‘ä»¬åªèƒ½æ§åˆ¶å®šæ—¶å™¨ä½•æ—¶è¢«åŠ å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè€Œæ— æ³•æ§åˆ¶å…¶ä½•æ—¶æ‰§è¡Œ</strong></p><p>å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//è¯·å†™å‡ºè¾“å‡ºå†…å®¹</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 start'</span>);</span><br><span class="line">    <span class="keyword">await</span> async2();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'async2'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script start'</span>);</span><br><span class="line"></span><br><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'setTimeout'</span>);</span><br><span class="line">&#125;, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">async1();</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'promise1'</span>);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'promise2'</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'script end'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">script start</span></span><br><span class="line"><span class="comment">async1 start</span></span><br><span class="line"><span class="comment">async2</span></span><br><span class="line"><span class="comment">promise1</span></span><br><span class="line"><span class="comment">script end</span></span><br><span class="line"><span class="comment">async1 end</span></span><br><span class="line"><span class="comment">promise2</span></span><br><span class="line"><span class="comment">setTimeout</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™ä¸ªä¾‹é¢˜å¯èƒ½ä¼šæœ‰ä¸€äº›åœ°æ–¹éš¾ç†è§£ï¼Œä¸»è¦æ˜¯asyncå’Œawait</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'async1 start'</span>);</span><br><span class="line"><span class="keyword">await</span> async2();</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'async1 end'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç­‰ä»·äºï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">async1</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'async1 start'</span>);</span><br><span class="line"><span class="built_in">Promise</span>.resolve(async2()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'async1 end'</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="nodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶"><a href="#nodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶" class="headerlink" title="nodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶"></a>nodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶</h2>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;äº‹ä»¶å¾ªç¯ï¼Œç”»ä¸ªåœˆåœˆâ€¦â€¦&lt;/p&gt;
    
    </summary>
    
      <category term="js" scheme="https://luckyjq.github.io/categories/js/"/>
    
    
      <category term="nodejs" scheme="https://luckyjq.github.io/tags/nodejs/"/>
    
      <category term="js" scheme="https://luckyjq.github.io/tags/js/"/>
    
      <category term="åŸºç¡€" scheme="https://luckyjq.github.io/tags/%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£typeofå’Œinstanceof</title>
    <link href="https://luckyjq.github.io/2019/04/17/%E7%90%86%E8%A7%A3typeof%E5%92%8Cinstanceof/"/>
    <id>https://luckyjq.github.io/2019/04/17/ç†è§£typeofå’Œinstanceof/</id>
    <published>2019-04-17T09:34:32.000Z</published>
    <updated>2019-07-03T01:36:52.458Z</updated>
    
    <content type="html"><![CDATA[<p>ç†è§£typeofå’Œinstanceofï¼Œä»åŸå‹å¼€å§‹è¯´èµ·</p><a id="more"></a><h2 id="typeofåˆ¤æ–­ç±»å‹å­˜åœ¨çš„é—®é¢˜"><a href="#typeofåˆ¤æ–­ç±»å‹å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="typeofåˆ¤æ–­ç±»å‹å­˜åœ¨çš„é—®é¢˜"></a>typeofåˆ¤æ–­ç±»å‹å­˜åœ¨çš„é—®é¢˜</h2><p>å¯¹äºè¿™ä¸¤ä¸ªjså…³é”®è¯ï¼Œä¸€ç›´åœç•™åœ¨å¾ˆæµ…æ˜¾çš„ç†è§£ä¸Šã€‚<br>ç›´åˆ°æœ€è¿‘å¼€å§‹åˆ·ä¸ªå¤§å…¬å¸çš„é¢è¯•é¢˜ï¼Œå‘ç°è¿™ä¸€çŸ¥è¯†ç‚¹å‡ºåœºä¹‹é«˜ï¼Œå†³å¿ƒæ€»ç»“ä¸€ä¸‹ã€‚</p><p>typeofåˆ¤æ–­ç±»å‹ï¼Œæˆªå›¾æ¥è‡ªMDNã€‚<br>é—®é¢˜å‡ºç°äº†ï¼Œå½“ç±»å‹ä¸ºNullå’ŒArrayå’ŒObjectæ—¶å€™ï¼Œå‡è¿”å›â€œobjectâ€ï¼Œå¦‚ä½•åŒºåˆ«ï¼Ÿ</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/943056903a1e3c5bb07bc83a471fa457.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>ä¸€ç§å¸¸ç”¨çš„æ£€æµ‹æ–¹æ³•æ˜¯ä½¿ç”¨ï¼š<br>Object.prototype.toString.call(obj)</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">12</span>,<span class="string">'aaa'</span>]</span><br><span class="line"><span class="built_in">Object</span>.prototype.toString.call(arr)  <span class="comment">//"[object Array]"</span></span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ObjectåŸå‹ä¸Šçš„toStringæ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ï¼Ÿ<br>å› ä¸ºArray ï¼Œfunctionç­‰ç±»å‹ä½œä¸ºObjectçš„å®ä¾‹ï¼Œéƒ½é‡å†™äº†toStringæ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.toString()  <span class="comment">//"12,aaa"</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹æ³•åˆ¤æ–­ä¹Ÿå­˜åœ¨å±€é™æ€§ï¼Œå¯¹äºä»»ä½•å¯¹è±¡ï¼Œè¿”å›éƒ½æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬ç°åœ¨çš„éœ€æ±‚æ˜¯æœ‰ä¸åŒæ„é€ å‡½æ•°æ¯”å¦‚Studentï¼ŒDogç­‰ç­‰ï¼Œæˆ‘ä»¬newä¸€ä¸ªå®ä¾‹çš„æ—¶å€™æƒ³åˆ¤æ–­è¿™ä¸ªå®ä¾‹æ˜¯ä¸€ä¸ªDogè¿˜æ˜¯ä¸€ä¸ªStudentï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°instanceofã€‚</p><h2 id="instanceofå¤§æ³•å¥½"><a href="#instanceofå¤§æ³•å¥½" class="headerlink" title="instanceofå¤§æ³•å¥½"></a>instanceofå¤§æ³•å¥½</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Student = <span class="function"><span class="keyword">function</span> (<span class="params">name,age</span>) </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name</span><br><span class="line"><span class="keyword">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line">Student.prototype.say = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`i am <span class="subst">$&#123;name&#125;</span>,and i am <span class="subst">$&#123;age&#125;</span> years old!`</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'Tom'</span>, <span class="number">20</span>)</span><br><span class="line">stu <span class="keyword">instanceof</span> Student   <span class="comment">//true</span></span><br></pre></td></tr></table></figure><p>è¦ç†è§£instanceofè‚¯å®šé€ƒä¸è¿‡åŸå‹é“¾ï¼Œç¥­å‡ºåŸå‹é“¾å¤§å›¾<br>ï¼ˆå¦‚æœè¿˜ä¸ç†è§£åŸå‹é“¾å¯ä»¥å‚è€ƒå…¶ä»–æ–‡ç« ï¼Œè¦æ±‚èƒ½æŠŠä¸‹é¢å›¾çœ‹æ‡‚ï¼‰</p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="http://gitblog.luckyq.cn/1f5e2ac23cb0ea276d64256d63949f07.jpg" alt title>                </div>                <div class="image-caption"></div>            </figure><p>å…³é”®ç‚¹ï¼š<br>é¦–å…ˆï¼Œjsä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡<br>æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰prototypeå’Œ<strong>proto</strong>å±æ€§<br>æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰<strong>proto</strong>å±æ€§<br>Object.prototypeæ˜¯æ‰€æœ‰å¯¹è±¡çš„æ ¹<br>Function.prototypeæ˜¯æ‰€æœ‰å‡½æ•°çš„æ ¹<br>Objectå’ŒFunctionéƒ½æ˜¯æ„é€ å‡½æ•°</p><p>instanceofçš„åˆ¤æ–­åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨å®ä¾‹çš„<strong>proto</strong>é“¾æ¡ä¸Šå¯»æ‰¾ï¼Œå¦‚æœæœ‰å°±è¿”å›true<br>é€šè¿‡ä¸Šé¢çš„å›¾ä¹Ÿå¯ä»¥ç†è§£å‡ ä¸ªå¾ˆå¥‡æ€ªçš„instanceofåˆ¤æ–­</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Function</span> <span class="keyword">instanceof</span> <span class="built_in">Function</span>  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Function</span>  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">Object</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span>  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">Function</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span>  <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>è¿™ä¸¤å¤©çœ‹ä¹¦ï¼Œå‘ç°è‡ªå·±å¯¹instanceofçš„ä½¿ç”¨æœ‰ä¸ªåœ°æ–¹è¿˜æ˜¯ä¸æ¸…æ¥š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Person.prototype.dance = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Ninja</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line">Ninja.prototype = <span class="keyword">new</span> Person()</span><br><span class="line"><span class="keyword">const</span> ninja = <span class="keyword">new</span> Ninja()</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬çš„jsç»§æ‰¿å†™æ³•ï¼Œä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ï¼š<br>Ninja.prototypeè¢«æ”¹å†™æˆä¸€ä¸ªPersonå®ä¾‹å¯¹è±¡äº†<br>æ‰€ä»¥:<br>ninja instanceof Ninjaè¿”å›falseï¼Œ<br>ninja instanceof Person è¿”å›true</p><p>ä½†æ˜¯æµ‹è¯•è¿”å›çš„æ˜¯ä¸¤ä¸ªtrue</p><p>åˆ°åº•è¯¥å¦‚ä½•ç†è§£instanceof?<br><strong>æ£€æŸ¥å³è¾¹çš„å‡½æ•°åŸå‹æ˜¯å¦å­˜åœ¨äºæ“ä½œç¬¦å·¦è¾¹çš„å¯¹è±¡çš„åŸå‹é“¾ä¸Š</strong><br>Ninja.prototype æ˜¯å¦åœ¨ninjaå¯¹è±¡çš„<strong>proto</strong>é“¾ä¸Š</p><p>å½“ä½ å®ä¾‹åŒ–æ—¶å€™ï¼Œconst ninja = new Ninja()<br>åˆ¤æ–­ninja instanceof Ninjaæ—¶ï¼Œå°±çœ‹Ninja.prototypeæ˜¯å¦åœ¨ninjaå®ä¾‹çš„<strong>proto</strong>é“¾æ¡ä¸Š<br>è€ŒNinja.prototypeæ˜¯new Personï¼Œåœ¨ninjaå®ä¾‹çš„<strong>proto</strong>é“¾æ¡ä¸Šï¼Œæ‰€ä»¥å°±è¿”å›true<br>è¿™æ ·æ‰æ˜¯æ­£ç¡®ç†è§£instanceofçš„æ–¹å¼</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç†è§£typeofå’Œinstanceofï¼Œä»åŸå‹å¼€å§‹è¯´èµ·&lt;/p&gt;
    
    </summary>
    
      <category term="js" scheme="https://luckyjq.github.io/categories/js/"/>
    
    
      <category term="js" scheme="https://luckyjq.github.io/tags/js/"/>
    
      <category term="åŸºç¡€" scheme="https://luckyjq.github.io/tags/%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
</feed>
