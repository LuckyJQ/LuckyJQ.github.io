[{"title":"ä¸ªäººå°é¡¹ç›®æˆªå›¾","date":"2019-07-24T16:00:00.000Z","path":"2019/07/25/é¡¹ç›®å›¾/","text":"ä¸¤ä¸ªç®€å•çš„å°é¡¹ç›® è¥¿ç”µæ ¡æ·˜å°ç¨‹åºè¿™ä¸ªé¡¹ç›®æ˜¯åœ¨å¤§ä¸‰æ—¶å€™åšçš„å°ç¨‹åºé¡¹ç›®ï¼Œåšçš„æ˜¯æ ¡å›­äºŒæ‰‹å¹³å°å‰ç«¯é¡µé¢éƒ½æ˜¯è‡ªå·±è®¾è®¡ï¼Œç”¨çš„åŸç”Ÿçš„å°ç¨‹åºç»„ä»¶åç«¯å½“æ—¶ä¸æ€ä¹ˆä¼šï¼Œç›´æ¥ç”¨çš„ç¬¬ä¸‰æ–¹çš„çŸ¥æ™“äº‘è¿™ä¸ªå°ç¨‹åºç°åœ¨è¿˜åœ¨çº¿ä¸Šã€‚ã€‚ è¥¿ç”µå†œè´¸å°ç¨‹åº+ç®¡ç†åå°å½“æ—¶æ˜¯ä¸€ä¸ªå¯¼å‘˜æ¨èç»™å­¦æ ¡ä¸€ä¸ªä¸“å–ç²®æ²¹çš„åšå°ç¨‹åºï¼Œæƒ³æ³•å°±æ˜¯å‰ä¸€å¤©æ™šä¸Šå¯ä»¥é¢„å®šï¼Œç„¶åç¬¬äºŒå¤©ä»–ç›´æ¥å»é€å°±å¯ä»¥äº†é¡µé¢å¾ˆç®€å•ï¼Œå½“æ—¶å­¦äº†ç‚¹nodeï¼Œæ‰€ä»¥ç›´æ¥æ’¸äº†ä¸€å¥—å…¨æ ˆçš„ï¼Œå¤§æ¦‚10å¤©å·¦å³å®Œæˆäº†ï¼Œç„¶åéƒ¨ç½²åœ¨è‡ªå·±çš„è…¾è®¯äº‘æœåŠ¡å™¨ä¸Šäº†ä¸è¿‡å½“æ—¶æ²¡æ³¨æ„mongodbé»˜è®¤æ˜¯ç©ºå¯†ç çš„ï¼Œç„¶åä¹‹å‰ä¸æ‡‚è…¾è®¯äº‘ä¸ºäº†æ–¹ä¾¿æŠŠæ‰€æœ‰ç«¯å£éƒ½å¼€äº†ï¼Œæ™¾å‡‰äº†ï¼Œæ•°æ®åº“è¢«æ¸…äº†ç°åœ¨æ²¡éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸è¿‡æœ‰æˆªå›¾ å°ç¨‹åº h5å®¢æˆ·ç«¯ webåå°","tags":[{"name":"koa2","slug":"koa2","permalink":"https://luckyjq.github.io/tags/koa2/"},{"name":"vue","slug":"vue","permalink":"https://luckyjq.github.io/tags/vue/"},{"name":"å°ç¨‹åº","slug":"å°ç¨‹åº","permalink":"https://luckyjq.github.io/tags/å°ç¨‹åº/"},{"name":"é¡¹ç›®","slug":"é¡¹ç›®","permalink":"https://luckyjq.github.io/tags/é¡¹ç›®/"}]},{"title":"å®ç°ä¸€ä¸ªç±»ä¼¼vueçš„åŒå‘ç»‘å®š","date":"2019-07-01T16:00:00.000Z","path":"2019/07/02/å®ç°ä¸€ä¸ªç±»ä¼¼vueçš„åŒå‘ç»‘å®š/","text":"vueç”¨äº†æœ‰æ®µæ—¶é—´äº†ï¼Œå‚è€ƒäº†githubçš„æ–‡ç« ï¼Œå†™äº†ä¸ªç®€åŒ–ç‰ˆ githubæ–‡ç« é“¾æ¥ï¼šhttps://github.com/DMQ/mvvmå¦‚æœçœ‹ä¸æ‡‚å°±çœ‹æˆ‘çš„å•Šï¼Œå˜¿å˜¿å˜¿ å‰è¨€ä½¿ç”¨Vueä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œvueä½œä¸ºä¸€ä¸ªMVVMæ¡†æ¶ï¼Œæœ€æœ‰åçš„å°±æ˜¯åŒå‘ç»‘å®šä¸€èˆ¬æ¥è¯´å½“æ•°æ®å˜åŒ–æ—¶ï¼Œè§†å›¾å±‚è·Ÿç€å˜åŒ–ï¼Œè¿™æ˜¯å•å‘çš„å½“è§†å›¾å±‚å˜åŒ–æ—¶ï¼Œæ•°æ®ä¹Ÿè·Ÿç€å˜ï¼Œè¿™å°±æ˜¯åŒå‘çš„æ¯”å¦‚åœ¨vueä¸­é€šè¿‡v-modelç»‘å®šçš„è¾“å…¥æ¡†ï¼Œå½“è¾“å…¥æ¡†å†…å€¼å˜åŒ–æ—¶æ•°æ®ä¹Ÿè·Ÿç€å˜åŒ– ä»Šå¤©å°±æ¥å®ç°ä¸€ä¸ªç±»ä¼¼äºvueçš„åŒå‘ç»‘å®šï¼Œé¢„æœŸæ•ˆæœï¼š 12345678910111213141516// è§†å›¾å±‚&lt;div id=\"app\"&gt; this is &#123;&#123;name&#125;&#125;, &#123;&#123;age&#125;&#125; years old! &lt;h1&gt; &#123;&#123;name&#125;&#125; &lt;/h1&gt;&lt;/div&gt;// æ•°æ®å±‚var vm = new MVVM(&#123; el: '#app', data: &#123; name: 'jianqi', age: 3 &#125;&#125;) Object.definePropertyçš„ä½¿ç”¨Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œ å¹¶è¿”å›è¿™ä¸ªå¯¹è±¡ã€‚MDN:https://dwz.cn/umKlHoaq å®šä¹‰å¯¹è±¡descriptoræ—¶æ³¨æ„äº‹é¡¹ï¼š å±æ€§æè¿°ï¼ˆconfigurableï¼Œenumerableï¼‰ï¼šé€šè¿‡è¿™ä¸ªå®šä¹‰çš„å±æ€§é»˜è®¤ä¸å¯è¢«åˆ é™¤ï¼ˆdelete obj.xxxï¼‰ï¼Œé»˜è®¤ä¸å¯éå†ï¼ˆfor inï¼‰ å€¼æè¿°ï¼ˆvalueï¼Œ writableï¼‰ï¼švalueå’Œwritableï¼Œvalueé»˜è®¤ä¸ºundefinedï¼Œwritableé»˜è®¤ä¸ºfalseå€¼ä¸èƒ½è¢«æ”¹å˜ å­˜å–æè¿°ï¼šgetï¼Œsetå‡½æ•° å€¼æè¿°ç¬¦å’Œå­˜å–æè¿°ç¬¦ä¸èƒ½åŒæ—¶å­˜åœ¨ è§‚å¯Ÿè€…æ¨¡å¼Subjectæ˜¯ä¸€ä¸ªä¸»é¢˜ï¼ˆç½‘ç«™ï¼‰ã€‚Observerç›¸å½“äºä¸€ä¸ªä¸ªçš„è§‚å¯Ÿè€…ï¼ˆç½‘æ°‘ï¼‰ï¼Œä»–ä»¬å¯ä»¥è®¢é˜…Subjectï¼Œå½“Subjectæ›´æ–°æ—¶é€šçŸ¥Observerï¼Œè§¦å‘Observerä¹‹å‰å®šä¹‰çš„å›è°ƒã€‚ 1234567891011121314151617181920212223242526272829303132333435363738//es6å®ç°class Subject &#123; constructor()&#123; this.state = 0 this.observers = [] &#125; getState() &#123; return this.state &#125; setState(state)&#123; this.state = state this.notifyAllObservers() &#125; notifyAllObservers()&#123; this.observers.forEach(observer=&gt;&#123; observer.update() &#125;) &#125; attach(observer) &#123; this.observers.push(observer) &#125;&#125;class Observer &#123; constructor(name, subject)&#123; this.name = name this.subject = subject this.subject.attach(this) &#125; update() &#123; console.log(`$&#123;this.name&#125; update,state:$&#123;this.subject.getState()&#125;`) &#125;&#125;let s = new Subject()let o = new Observer('o', s)let o2 = new Observer('o2', s)s.setState(1) å®ç°åŸç†é€šè¿‡ä½¿ç”¨Object.definePropertyï¼ˆæ•°æ®æ‹¦æˆªï¼‰å’Œè§‚å¯Ÿè€…æ¨¡å¼å®ç°åŒå‘ç»‘å®šåŸç†å›¾ï¼š ä¸»é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ ä¸€ä¸ªä¸ªkeyï¼Œæ¯”å¦‚name è§‚å¯Ÿè€…æ˜¯ä»€ä¹ˆï¼Ÿ è§†å›¾é‡Œé¢çš„ï¼Œéœ€è¦è¢«æ›¿æ¢æˆæ•°æ®çš„åœ°æ–¹ è§‚å¯Ÿè€…ä»€ä¹ˆæ—¶å€™è®¢é˜…ï¼Ÿä¸€å¼€å§‹æ‰§è¡ŒMVVMåˆå§‹åŒ–æ—¶å€™æ ¹æ®eléå†domèŠ‚ç‚¹ï¼Œå‘ç°æ—¶å€™æ—¶è®¢é˜…å¯¹åº”ä¸»é¢˜xxxx ä¸»é¢˜ä»€ä¹ˆæ—¶å€™é€šçŸ¥æ›´æ–°ï¼Ÿå½“xxxxæ”¹å˜æ—¶ï¼Œé€šçŸ¥è§‚å¯Ÿè€…æ›´æ–°å†…å®¹ã€‚å¯ä»¥åœ¨ä¸€å¼€å§‹å°±ç›‘æ§dataé€šè¿‡Object.defineProperty()å®ç° å®ç°å•å‘æ•°æ®æµï¼ˆæ•°æ®=&gt;è§†å›¾ï¼‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139// æ€»å…¥å£class MVVM &#123; constructor(opts)&#123; // åˆå§‹åŒ–ï¼Œç»‘å®šæ•°æ®åˆ°vmå¯¹è±¡ä¸Š this.init(opts) // éå†æ‰€æœ‰dataå€¼ï¼Œè®¾ç½®getå’Œsetæ–¹æ³• observe(this.$data) // éå†domæ ‘ï¼ŒæŸ¥æ‰¾&#123;&#123;&#125;&#125;çš„ç‰¹æ®Šæ ‡è®° this.compile() &#125; init(opts)&#123; this.$el = document.querySelector(opts.el) this.$data = opts.data &#125; compile()&#123; this.traverse(this.$el) &#125; traverse(node)&#123; if(node.nodeType === 1)&#123; node.childNodes.forEach(childNode=&gt;&#123; this.traverse(childNode) &#125;) &#125; else if(node.nodeType === 3)&#123; this.renderText(node) &#125; &#125; renderText(node)&#123; let reg = /&#123;&#123;(.+?)&#125;&#125;/g let match while (match = reg.exec(node.nodeValue))&#123; let raw = match[0] let key = match[1].trim() // åˆå§‹åŒ–æ—¶ç»‘å®šdataé‡Œçš„æ•°æ®åˆ°è§†å›¾å¯¹åº”èŠ‚ç‚¹ node.nodeValue = node.nodeValue.replace(raw, this.$data[key]) // å¯¹å½“å‰çš„keyè®¾ç½®ç›‘å¬ new Observer(this, key, function (val, oldVal) &#123; node.nodeValue = node.nodeValue.replace(oldVal, val) &#125;) &#125; &#125;&#125;let currentObserver = null// éå†dataï¼Œæ·»åŠ ç›‘å¬çš„observeæ–¹æ³•function observe(data) &#123; if(!data || typeof data !== 'object') return for(var key in data)&#123; //å¦‚æœä¸‹é¢çš„getæ–¹æ³•ç›´æ¥è¿”å›data[key]ä¼šå¼•èµ·å¾ªç¯è°ƒç”¨å¯¼è‡´æ ˆæº¢å‡º let val = data[key] //æ¯ä¸€ä¸ªkeyéƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„subject let subject = new Subject() Object.defineProperty(data, key, &#123; enumerable: true, configurable: true, get: function () &#123; console.log('run get') // currentObserveræ˜¯ä¸€ä¸ªå…¨å±€çš„å¯¹è±¡ if(currentObserver)&#123; // è®¢é˜…æŸä¸€ä¸ªsubjectï¼ˆdataä¸­çš„æŸä¸€ä¸ªé”®å€¼å¯¹çš„keyï¼‰ currentObserver.subscribeTo(subject) &#125; return val &#125;, set: function (newVal) &#123; val = newVal console.log('run set') // æ›´æ”¹äº†å€¼ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…è€… subject.notify() &#125; &#125;) if(typeof val === 'object')&#123; observe(val) &#125; &#125;&#125;// ä¸»é¢˜Subjectï¼Œdataä¸­çš„æ¯ä¸€ä¸ªkeyéƒ½æ˜¯ä¸€ä¸ªsubjectclass Subject &#123; constructor()&#123; // ä¸€ä¸ªä¸»é¢˜ä¼šæœ‰å¤šä¸ªè®¢é˜…è€…ï¼Œæ¯”å¦‚è¯´åœ¨è§†å›¾ä¸­ä¼šæœ‰å¤šä¸ªåœ°æ–¹æœ‰&#123;&#123;name&#125;&#125; this.observers = [] &#125; addObserver(observer)&#123; this.observers.push(observer) &#125; notify()&#123; this.observers.forEach(observer=&gt;&#123; observer.update() &#125;) &#125;&#125;// è®¢é˜…è€…Observerclass Observer &#123; constructor(vm, key, cb)&#123; this.vm = vm this.key = key this.cb = cb // currentObserveræ˜¯ä¸€ä¸ªå…¨å±€çš„å˜é‡ï¼Œè®¾ç½®ä»–æœ‰å€¼ // å¹¶æ‰§è¡Œä¸‹ä¸€è¡Œè§¦å‘getæ–¹æ³•ï¼Œä¼šè¿è¡Œobserveæ–¹æ³•ä¸­çš„è®¢é˜…æ“ä½œ currentObserver = this this.value = this.getValue() currentObserver = null &#125; update()&#123; let oldVal = this.value let value = this.getValue() if(value !== oldVal)&#123; this.value = value this.cb.bind(this.vm)(value, oldVal) &#125; &#125; subscribeTo(subject)&#123; subject.addObserver(this) &#125; getValue()&#123; // è¿™é‡Œä¼šè§¦å‘dataä¸­å…ƒç´ çš„getå‡½æ•° let value = this.vm.$data[this.key] return value &#125;&#125;` 1234567891011121314// è°ƒç”¨&lt;div id=\"app\"&gt; this is &#123;&#123;name&#125;&#125;, &#123;&#123;age&#125;&#125; years old!&lt;/div&gt; &lt;script type=\"text/javascript\"&gt; var vm = new MVVM(&#123; el: '#app', data: &#123; name: 'jianqi', age: 3 &#125; &#125;)&lt;/script&gt; å®ç°åŒå‘ç»‘å®šåœ¨vueä¸­ï¼Œå¦‚æœè¦å¯¹ä¸€ä¸ªinputæ¡†è¿›è¡ŒåŒå‘ç»‘å®šï¼Œéœ€è¦è®¾ç½®v-modelæŒ‡ä»¤è¿™é‡Œæˆ‘ä»¬è¿›è¡Œç›¸åŒçš„è®¾ç½®ï¼Œå¯¹äºè®¾ç½®äº†v-modelçš„inputå®ç°åŒå‘ç»‘å®šåœ¨å‰é¢å·²ç»å®ç°å•å‘æ•°æ®æµçš„åŸºç¡€ä¸Šå¾ˆå®¹æ˜“å®ç°åŒå‘ç»‘å®šåœ¨è§£ædomæ—¶å€™æ£€æµ‹v-modelæŒ‡ä»¤ï¼Œå¯¹åº”çš„å…ƒç´ ç»‘å®šç›‘å¬äº‹ä»¶ï¼Œå½“å€¼æ”¹å˜æ—¶è§¦å‘è®¾ç½®dataå³å¯ 12345678910111213141516171819202122232425262728293031323334353637// ä¿®æ”¹ä¸Šé¢ä»£ç çš„MVVMclass MVVM &#123; // ...... traverse(node)&#123; if(node.nodeType === 1)&#123; this.compileNode(node) node.childNodes.forEach(childNode=&gt;&#123; this.traverse(childNode) &#125;) &#125; else if(node.nodeType === 3)&#123; this.renderText(node) &#125; &#125; // ...... compileNode(node)&#123; let attrs = [...node.attributes] attrs.forEach(attr=&gt;&#123; if(this.isDirective(attr.name))&#123; let key = attr.value node.value = this.$data[key] new Observer(this, key, function (newVal) &#123; node.value = newVal &#125;) node.oninput = (e)=&gt;&#123; this.$data[key] = e.target.value &#125; &#125; &#125;) &#125; isDirective(attrName)&#123; return attrName === 'v-model' &#125;&#125;` è°ƒç”¨ 123456789101112131415161718// è°ƒç”¨&lt;div id=\"app\"&gt; this is &#123;&#123;name&#125;&#125;, &#123;&#123;age&#125;&#125; years old! &lt;h1&gt; &#123;&#123;name&#125;&#125; &lt;/h1&gt; &lt;input type=\"text\" v-model=\"name\"&gt;&lt;/div&gt; &lt;script type=\"text/javascript\"&gt; var vm = new MVVM(&#123; el: '#app', data: &#123; name: 'jianqi', age: 3 &#125; &#125;)&lt;/script&gt; ä¼˜åŒ–","tags":[{"name":"vue","slug":"vue","permalink":"https://luckyjq.github.io/tags/vue/"},{"name":"æºç ","slug":"æºç ","permalink":"https://luckyjq.github.io/tags/æºç /"}]},{"title":"koa2å…¥é—¨","date":"2019-06-28T16:00:00.000Z","path":"2019/06/29/koa2å…¥é—¨/","text":"å¤§æ‚çƒ©ï¼Œè®°å½•è´´ã€‚åŒ…å«ä¸€ä¸ªç®€ç‰ˆkoaæ¡†æ¶çš„æ ¸å¿ƒå®ç° å‰ç½®çŸ¥è¯†ï¼šå…³äºasyncå’Œawaitçš„ç†è§£https://segmentfault.com/a/1190000007535316 awaitå¿…é¡»åŒ…è£¹åœ¨asyncå‡½æ•°é‡Œ asyncå‡½æ•°æ‰§è¡Œè¿”å›çš„æ˜¯ä¸€ä¸ªpromiseå¯¹è±¡ awaitåœ¨ç­‰ä»€ä¹ˆï¼Ÿç­‰ä¸€ä¸ªpromiseï¼Œè·å–ä»–çš„resolveçš„å€¼ å¦‚æœawaitåé¢çš„promiseè¿”å›çš„æ˜¯rejectçš„å€¼ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨tryï¼Œcatchè¿›è¡ŒåŒ…è£¹ koa2åŸç†ï¼ˆuseå’Œnextï¼‰æºç è§£è¯»ï¼šhttps://zhuanlan.zhihu.com/p/34797505 è‡ªå·±å®ç°ä¸€ä¸ªç®€ç‰ˆ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061const http = require('http')// ç»„åˆä¸­é—´ä»¶function compose(middlewareList) &#123; return function (ctx) &#123; //dispatchå‡½æ•°ç”¨äºæ‰§è¡Œä¸€ä¸ªä¸­é—´ä»¶ function dispatch(i) &#123; const fn = middlewareList[i] try &#123; return Promise.resolve( //è¿™é‡Œfnçš„ç¬¬äºŒä¸ªå‚æ•°å°±ç›¸å½“äºnext fn(ctx, dispatch.bind(null, i + 1)) // promise ) &#125; catch (err) &#123; return Promise.reject(err) &#125; &#125; return dispatch(0) &#125;&#125;class LikeKoa2 &#123; constructor() &#123; this.middlewareList = [] &#125; use(fn) &#123; this.middlewareList.push(fn) return this &#125; createContext(req, res) &#123; const ctx = &#123; req, res &#125; ctx.query = req.query return ctx &#125; handleRequest(ctx, fn) &#123; return fn(ctx) &#125; callback() &#123; const fn = compose(this.middlewareList) return (req, res) =&gt; &#123; const ctx = this.createContext(req, res) return this.handleRequest(ctx, fn) &#125; &#125; listen(...args) &#123; const server = http.createServer(this.callback()) server.listen(...args) &#125;&#125;module.exports = LikeKoa2 koa2çš„ctxå¯¹è±¡koa2çš„ctxå°è£…äº†reqå’Œresï¼Œå¯ä»¥é€šè¿‡ctxç›´æ¥å–å¾—ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ctx.request.xxçš„å½¢å¼å–å¾—å¸¸ç”¨çš„ï¼š ctx.params ctx.request.query ctx.request.header ctx.request.body( éœ€è¦ä½¿ç”¨body-parseræ’ä»¶) åˆ©ç”¨cookieå’Œsessionè¿›è¡Œé‰´æƒä½œä¸ºä¸€ä¸ªç½‘ç«™æœ‰äº›èµ„æºéœ€è¦ç™»é™†æ‰èƒ½è®¿é—®ï¼Œæœ‰äº›ä¸ç™»é™†ä¹Ÿå¯ä»¥æµè§ˆã€‚å¦‚ä½•å®ç°é‰´æƒï¼Ÿå¸¸ç”¨çš„æ–¹æ³•æ˜¯cookieå’Œsession è¿™é‡Œå‡è®¾sessionå­˜å‚¨åœ¨æœåŠ¡ç«¯å†…å­˜ä¸­ï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„SESSION[ ] ç”¨æˆ·è®¿é—®æŸä¸ªurlæ—¶ï¼Œè¿›è¡Œç”¨æˆ·é‰´æƒï¼Œæœ‰æ— cookie æ²¡æœ‰cookieï¼Œå“åº”è®¾ç½®cookie,æ¯”å¦‚userid: xxx01ï¼Œåœ¨æœåŠ¡ç«¯SESSION[ ]ä¸­æ·»åŠ ä¸€ä¸ªsession{xxx01:{ }} ç”¨æˆ·ç™»é™†ï¼Œå¾€SESSIONä¸­å¯¹åº”çš„sessionå¯¹è±¡ä¸­å†™å­—æ®µï¼Œæ¯”å¦‚username: xxxã€‚æ­¤æ—¶SESSONæ•°ç»„ä¸­æœ‰ä¸€ä¸ªsessionåº”è¯¥æ˜¯è¿™æ ·çš„ï¼šssession{xxx01:{username: xxx}} è¯·æ±‚æ—¶æºå¸¦cookieï¼ŒæœåŠ¡ç«¯è·å–useridå»SESSIONä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œçœ‹usernameæ˜¯å¦æœ‰å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ç™»é™†äº† æ³¨æ„äº‹é¡¹ï¼š è®¾ç½® cookieæ—¶åº”å½“è®¾ç½®è¿‡æœŸæ—¶é—´ sessionå­˜å‚¨åœ¨æœåŠ¡å™¨ä¸­é‡å¯å°±æ²¡äº†ï¼Œéœ€è¦è¿›è¡ŒæŒä¹…åŒ–ã€‚å¯ä»¥è€ƒè™‘å­˜åœ¨redisä¸­æˆ–è€…ç›´æ¥åŠ å¯†åè¿”å›åˆ°cookieä¹Ÿå¯ä»¥ koa2å¸¸ç”¨æ’ä»¶ç™»é™†é‰´æƒç›¸å…³ koa-sessionï¼ˆæŠŠsessionåŠ å¯†åå­˜åœ¨cookieä¸­ï¼Œæ”¯æŒå¤–éƒ¨æ•°æ®åº“ï¼‰æºç è§£è¯»æ–‡ç« ï¼šhttps://segmentfault.com/a/1190000012412299 koa-generic-sessionï¼Œkoa-redisï¼ˆè¿™ä¸¤ä¸ªé…å¥—å¯ä»¥å­˜å‚¨sessionåˆ°redisï¼‰ Sequelizeï¼Œæ“ä½œmysqlæ•°æ®åº“ï¼ˆå¦‚æœé“¾æ¥mysqléœ€è¦å®‰è£…mysql2é©±åŠ¨ï¼‰ å¼‚å¸¸å¤„ç†jsä¸­try catchåªèƒ½æ•æ‰åŒæ­¥é”™è¯¯å¼‚æ­¥ä»£ç çš„é”™è¯¯å¾ˆéš¾ï¼Œé€šè¿‡ä½¿ç”¨promiseå’Œasyncå’Œawaitå¯ä»¥ç®€åŒ–å¼‚æ­¥çš„é”™è¯¯å¤„ç†ï¼Œä½¿ç”¨tryå’Œcatchä¸‹é¢è¿™æ ·ä¹Ÿæ˜¯æ²¡ç”¨çš„ï¼Œå¿…é¡»è¿”å›å¼‚æ­¥å‡½æ•°çš„promiseåŒ…è£… è¿™æ ·æ‰å¯¹ AOPæ€æƒ³è‡ªå®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†å‡½æ•°ï¼Œæœ€å…ˆæ³¨å†Œï¼Œtry next()å³å¯ï¼Œç›¸å½“äºè°ƒç”¨é“¾æ¡ å°è£…é”™è¯¯å¯¹è±¡çŠ¶æ€ç error codeerror messagerequest url å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„å¼‚å¸¸é…ç½®å¼€å‘ç¯å¢ƒä¸‹å…¨å±€çš„éhttpErroræ•æ‰éœ€è¦å†æŠ›å‡ºå»ï¼Œæ–¹ä¾¿å¼€å‘æ—¶å€™è°ƒè¯•ç”Ÿäº§ç¯å¢ƒå°±ä¸è¦æŠ›äº† ä¸€ä¸ªä½œä¸šé¢˜ 123456789101112131415161718192021222324class A &#123; constructor() &#123; this.nameA = 'a' this.nameD = 'd' &#125; validateA() &#123; console.log(\"A\") &#125;&#125;class B extends A &#123; constructor() &#123; super() this.nameB = 'b' &#125; validateB() &#123; console.log(\"B\") &#125;&#125;var b = new B()// ç¼–å†™ä¸€ä¸ªå‡½æ•°findMembers,è·å–bçš„æ‰€æœ‰å¸¦å‰ç¼€çš„å±æ€§å’Œæ–¹æ³•const members = findMembers2(b, 'name', 'validate')","tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://luckyjq.github.io/tags/nodejs/"},{"name":"koa2","slug":"koa2","permalink":"https://luckyjq.github.io/tags/koa2/"}]},{"title":"ä½¿ç”¨nodejsåŸç”Ÿhttpå¼€å‘apiæ¥å£","date":"2019-06-24T04:31:41.808Z","path":"2019/06/24/nodejs/","text":"æ€»ä½“æ¶æ„ å¼€å‘ç¯å¢ƒæ­å»ºä½¿ç”¨webstormè¿›è¡Œå¼€å‘ï¼Œæ–°å»ºé¡¹ç›®ï¼Œå‘ç°æ²¡æœ‰nodejsæ™ºèƒ½æç¤ºå®‰è£…nodeæ™ºèƒ½æç¤º é€šè¿‡npm initæ–°å»ºé¡¹ç›®ä¸¤ä¸ªå¥½ç”¨çš„æ’ä»¶ï¼šå…¨å±€å®‰è£…nodemonï¼Œæ”¯æŒçƒ­é‡è½½é¡¹ç›®å®‰è£…cross-envï¼Œå…¼å®¹æ“ä½œç³»ç»Ÿ é…ç½®package.jsonçš„scripté€‰é¡¹é…ç½®ä¸­çš„NODE_ENV=devï¼Œå½“ä»¥npm run devå¯åŠ¨æ—¶ï¼Œprocess.env.NODE_ENVçš„å€¼å°±ä¸ºdev 12\"dev\": \"cross-env NODE_ENV=dev nodemon ./bin/www.js\",\"prd\": \"cross-env NODE_ENV=production nodemon ./bin/www.js\" è®¾è®¡æ¥å£ å“åº”ç»“æ„è®¾è®¡123456789101112//æˆåŠŸ&#123; errno: 0, data: &#123;&#125;, message: ''&#125;//å¤±è´¥&#123; errno: -1, message: ''&#125; é€šè¿‡es6çš„classæ–°å»ºå“åº”æ¨¡å‹ 12345678910111213141516171819202122232425262728293031323334class BaseModel &#123; constructor(data, message) &#123; if(typeof data === 'string')&#123; this.message = data data = null message = null &#125; if(data) &#123; this.data = data &#125; if(message)&#123; this.message = message &#125; &#125;&#125;class SuccessModel extends BaseModel &#123; constructor(data, message)&#123; super(data, message) this.errno = 0 &#125;&#125;class ErrorModel extends BaseModel &#123; constructor(data, message)&#123; super(data, message) this.errno = -1&#125;&#125;module.exports = &#123; SuccessModel, ErrorModel&#125; é¡¹ç›®ç»“æ„æ‹†åˆ†å°†å¯åŠ¨æœåŠ¡å™¨å°è£…æˆwww.jsï¼Œå¤–éƒ¨ä¼ å…¥æœåŠ¡å™¨å“åº”å‡½æ•°å“åº”å‡½æ•°åœ¨app.jsä¸­è¿›è¡Œå®šä¹‰ï¼Œå‡½æ•°ä¸­éƒ½å¯ä»¥å¼•ç”¨reqï¼Œreså¯¹è±¡å¯¹è·¯ç”±è¿›è¡Œæ‹†åˆ†ï¼Œåšå®¢è·¯ç”±å’Œç”¨æˆ·è·¯ç”±ï¼Œåœ¨app.jsä¸­è¿›è¡Œå¼•ç”¨app.jsä¸­å¼•ç”¨è·¯ç”±å¯¹æ‰€æœ‰è¯·æ±‚æ‹¦æˆªå¤„ç†ï¼Œæœ‰å¯¹åº”è·¯ç”±è¿”å›æ•°æ®å¦åˆ™è¿”å›404æ–°å»ºcontrolleræ–‡ä»¶å¤¹ï¼Œä¸»è¦ç”¨äºæ“ä½œæ•°æ®ï¼Œç„¶ååœ¨routerä¸­å¼•ç”¨å¯¹åº”controllerä¸­çš„æ–¹æ³•routerä¸­è°ƒç”¨controlleræ–¹æ³•è·å¾—æ•°æ®ï¼Œå°è£…æˆå“åº”modelå¹¶è¿”å›æ•°æ®æ–°å¢é…ç½®æ–‡ä»¶ï¼Œé…ç½®mysqlå’Œredisé“¾æ¥ä¿¡æ¯å°è£…mysqlé“¾æ¥å·¥å…·ï¼Œå°è£…æ‰§è¡Œsqlå‡½æ•° å¯¹promiseçš„ä¸€äº›ç–‘æƒ‘ç¢°åˆ°çš„ä¸€äº›å°bugsqlè¯­å¥å®šä¹‰çš„ä¸è§„èŒƒï¼Œ${username}åº”è¯¥è¦åŠ ä¸Šå¼•å· 1const sql = `select username, realname from user where username=$&#123;username&#125; and password=$&#123;password&#125;` æ—¥å¿—ç³»ç»Ÿ1.è®¿é—®æ—¥å¿—2.è‡ªå®šä¹‰æ—¥å¿—ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰äº‹ä»¶ï¼Œé”™è¯¯è®°å½•ç­‰ é€šè¿‡æµå¯¹è±¡å†™æ—¥å¿—æ—¥å¿—çš„æ‹†åˆ†ï¼ŒæŒ‰ç…§å¤©ç­‰ï¼ˆé€šå¸¸ç”¨linuxçš„å®šæ—¶ä»»åŠ¡crontabï¼‰ sqlæ³¨å…¥çš„dé˜²èŒƒä½¿ç”¨mysqlçš„escapeå‡½æ•°ï¼Œæ‰€æœ‰çš„å­—æ®µå…ˆç”¨escapeè½¬ä¹‰ç„¶ådadaw${xxx}ä¸­çš„${xx}å°±ä¸ç”¨åŠ å¼•å·äº† npm xssæ¨¡å—","tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://luckyjq.github.io/tags/nodejs/"}]},{"title":"ä½¿ç”¨ä¸ƒç‰›äº‘ä¸€é”®ä¸Šä¼ åšå®¢å›¾ç‰‡ï¼ˆmacï¼‰","date":"2019-06-23T16:00:00.000Z","path":"2019/06/24/ä½¿ç”¨ä¸ƒç‰›äº‘ä¸€é”®ä¸Šä¼ åšå®¢å›¾ç‰‡ï¼ˆmac)/","text":"å˜€ï½å°å§å§ç§’ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘å•¦ï¼ å†™åšå®¢çš„æ•ˆç‡åˆæå‡äº†ï¼ éšä¾¿BBhexoçš„åšå®¢å¾ˆæ—©ä¹‹å‰å°±æ­å»ºäº†ï¼Œé›¶é›¶æ•£æ•£å†™è¿‡å‡ ç¯‡æ–‡ç« ã€‚ç°åœ¨å¤§å­¦ç”Ÿæ´»ä¹Ÿç»“æŸäº†ï¼Œå³å°†æ­¥å…¥ç ”ç©¶ç”Ÿï¼Œæ‰“ç®—å¥½å¥½åˆ©ç”¨è¿™ä¸ªæš‘å‡ã€‚é‡æ–°æ‹¾èµ·åšå®¢ï¼Œå½“ä½œä¸€ä¸ªè®°å½•çš„å°åœ°æ–¹ã€‚ ä¹‹å‰æˆ‘å¾ˆè®¨åŒåœ¨hexoä¸Šå†™åšå®¢ï¼Œå› ä¸ºå›¾ç‰‡é…ç½®æ˜¯åœ¨æ˜¯å¤ªéº»çƒ¦äº†ï¼Œé¦–å…ˆå¾—å‡†å¤‡å¥½åšå®¢çš„ç…§ç‰‡ï¼Œç„¶åä¸Šä¼ åˆ°æŸä¸€ä¸ªå›¾ä¼ ï¼Œå†æ‹¿åˆ°å›¾ç‰‡åœ°å€æŒ‰ç…§ç‰¹å®šæ ¼å¼æ’å…¥æ–‡ç« ã€‚è¿™å€’ä¹Ÿè¿˜å¥½ï¼Œå…³é”®æ˜¯é‚£äº›å…è´¹å›¾åºŠè€æ˜¯å®¹æ˜“æŒ‚ã€‚ã€‚ã€‚å¥½ä¸å®¹æ˜“ç”³è¯·äº†ä¸ƒç‰›äº‘ï¼Œç«Ÿç„¶éœ€è¦ç»™ç©ºé—´ç»‘å®šåŸŸåï¼Œæµ‹è¯•åŸŸååªèƒ½ç”¨ä¸€ä¸ªæœˆï¼Œè›‹ç–¼ã€‚ ç»ˆäºã€‚ã€‚æˆ‘ç”³è¯·å¥½äº†ç‹¬ç«‹åŸŸåï¼Œé€šè¿‡äº†å¤‡æ¡ˆï¼Œæœ‰äº†è¶³å¤Ÿçš„æ—¶é—´å’Œçƒ­æƒ…ã€‚ã€‚æˆ‘åˆå›å‘äº†ã€‚ å®ç°åŸç†Alfredæ˜¯ä¸ªä»€ä¹ˆæˆ‘ä¹Ÿæ²¡ä»”ç»†ç ”ç©¶ï¼Œå¤§æ¦‚å°±æ˜¯ä¸€ä¸ªæ•ˆç‡å·¥å…·ï¼Œæœ€ğŸ‚çš„åœ°æ–¹æ˜¯å®ƒæ”¯æŒè‡ªå®šä¹‰è„šæœ¬ï¼Œç„¶åå®ç°è‡ªåŠ¨åŒ–æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å°±æ˜¯è¦åˆ©ç”¨è¿™ä¸ªå·¥å…·å’Œä¸ƒç‰›çš„å¼€æ”¾SDKå®Œæˆä¸€ä¸ªè‡ªåŠ¨åŒ–æ“ä½œã€‚ å½“ç„¶ã€‚ã€‚æœ‰äººå·²ç»å†™å¥½äº†è¿™ä¸ªè‡ªåŠ¨åŒ–è„šæœ¬äº†é¡¹ç›®åœ°å€ï¼šhttps://github.com/jiwenxing/qimage-mac æ­£å¼å¼€å¹²1.ä¸‹è½½Alfredï¼Œéœ€è¦ä½¿ç”¨ä»–çš„æ”¶è´¹åŠŸèƒ½ï¼Œä¸‹é¢ä¼šç»™å‡ºç ´è§£ç‰ˆã€‚ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1mir5F6Kæå–ç ï¼šjj7s 2.å®‰è£…ä¸ƒç‰›äº‘çš„SDKå·¥å…·ä¸‹è½½åœ°å€ï¼šhttps://developer.qiniu.com/kodo/tools/1302/qshellä¸‹è½½å®Œåè§£å‹ï¼ŒæŠŠqshell_darwin_amd64æ–‡ä»¶é‡å‘½åä¸ºqshellå¹¶ç§»è‡³usr/local/binç›®å½•ä¸‹å³å¯ã€‚åé¢çš„è„šæœ¬ä¼šå¼•ç”¨è¿™ä¸ªSDKã€‚ 3.æ³¨å†Œä¸ƒç‰›äº‘è´¦å·å¹¶å®åè®¤è¯è‡ªå·±å»æ³¨å†Œã€‚æœ€å¥½å†å‡†å¤‡ä¸€ä¸ªç‹¬ç«‹åŸŸåï¼Œå› ä¸ºä¸ƒç‰›çš„æµ‹è¯•åŸŸåæœ‰æ•ˆæœŸåªæœ‰ä¸€ä¸ªæœˆã€‚ 4.ä¸‹è½½githubè„šæœ¬ï¼Œè¿è¡Œqimage.alfredworkflow ä¿®æ”¹ä¸­é—´çš„ Run Scriptï¼Œå…·ä½“æ“ä½œè§ä¸‹é¢é“¾æ¥ã€‚https://github.com/jiwenxing/qimage-mac/issues/16 ä¿®æ”¹Hotkeyè¿›è¡Œè‡ªåŠ¨åŒ–è§¦å‘å¿«æ·é”®è®¾ç½®ï¼Œæ¨ècmd+option+vã€‚ ç°åœ¨ä½ å¯ä»¥è¯•ä¸€è¯•äº†ï¼Œcmd+cå¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ°å‰ªåˆ‡æ¿ï¼Œåœ¨mdæ–‡ä»¶é‡Œcmd+option+vğŸ˜¯ ä»–è¿”å›äº†mdçš„å›¾ç‰‡å¼•ç”¨æ ¼å¼ï¼Œå†™åšå®¢æ•ˆç‡åˆæå‡äº†å‘¢ï¼ å½“ç„¶ä½ å¯èƒ½ä¼šéœ€è¦ä¸€äº›å®šåˆ¶åŒ–çš„å°å˜åŒ–ï¼Œè¿™æ—¶å€™ä½ å°±è¦ç¨å¾®è¯»ä¸€ä¸‹è„šæœ¬ç„¶åè¿›è¡Œä¿®æ”¹äº†ã€‚ ä¼ ä¸ªå°å§å§è¯•è¯•æ°´ï¼ å–‚ï¼å°å¦¹å¦¹ï¼ä½ è·Ÿè°æ’’å¨‡å‘¢ï¼","tags":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"https://luckyjq.github.io/tags/å·¥å…·/"},{"name":"éªšæ“ä½œ","slug":"éªšæ“ä½œ","permalink":"https://luckyjq.github.io/tags/éªšæ“ä½œ/"}]},{"title":"æµè§ˆå™¨å’Œnodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶","date":"2019-04-20T16:00:00.000Z","path":"2019/04/21/æµè§ˆå™¨å’Œnodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶/","text":"äº‹ä»¶å¾ªç¯ï¼Œç”»ä¸ªåœˆåœˆâ€¦â€¦ æµè§ˆå™¨çš„äº‹ä»¶å¾ªç¯æœºåˆ¶æµè§ˆå™¨äº‹ä»¶å¾ªç¯å›¾ï¼ˆæ‘˜è‡ªã€Šjavascriptå¿è€…ç§˜ç±ç¬¬äºŒç‰ˆã€‹13ç« ï¼‰ï¼š å®ä»»åŠ¡å¾®ä»»åŠ¡å®ä»»åŠ¡ï¼šä»æµè§ˆå™¨è§’åº¦ï¼Œä»£è¡¨ä¸€ä¸ªç¦»æ•£çš„ï¼Œç‹¬ç«‹çš„å·¥ä½œå•å…ƒæ¯”å¦‚ï¼šåˆ›å»ºä¸»æ–‡æ¡£å¯¹è±¡ï¼Œè§£æHTMLï¼Œæ‰§è¡Œä¸»çº¿ï¼ˆå…¨å±€ï¼‰jsä»£ç æ›´æ”¹å½“å‰URLå’Œå„ç§äº‹ä»¶ï¼ˆé¡µé¢åŠ è½½ï¼Œç½‘ç»œäº‹ä»¶ï¼Œå®šæ—¶å™¨ç­‰ï¼‰ å¾®ä»»åŠ¡ï¼šæ˜¯æ›´å°çš„ä»»åŠ¡ï¼Œå¾®ä»»åŠ¡è¦å°½å¯èƒ½å¿«çš„ï¼Œé€šè¿‡å¼‚æ­¥æ–¹å¼æ‰§è¡Œæ¯”å¦‚ï¼šDOMå˜åŒ–ï¼ˆMutationObserverï¼‰ï¼ŒPromiseå›è°ƒå‡½æ•°ç”±äºå› ä¸ºasync await æœ¬èº«å°±æ˜¯promise+generatorçš„è¯­æ³•ç³–ï¼Œæ‰€ä»¥awaitåé¢çš„ä¹Ÿæ˜¯ ä»é¢è¯•é¢˜ç†è§£è¿è¡Œæœºåˆ¶123456789101112// å†™å‡ºè¾“å‡ºsetTimeout(function () &#123; console.log(1);&#125;);new Promise(function(resolve,reject)&#123; console.log(2) resolve(3)&#125;).then(function(val)&#123; console.log(val);&#125;)console.log(4); ä¸Šé¢çš„ä»£ç æ‰§è¡Œç»“æœä¸ºï¼š2ï¼Œ4ï¼Œ3ï¼Œ1æˆ‘ä»¬ç»“åˆä¸Šé¢çš„äº‹ä»¶å¾ªç¯å›¾æ¥ç†è§£ä¸‹è¾“å‡ºç»“æœ é¦–å…ˆæ‰§è¡Œä¸»çº¿ï¼ˆå…¨å±€jsä»£ç ï¼‰ï¼Œç¢°åˆ°å®šæ—¶å™¨ä»£ç ï¼Œå®šæ—¶å™¨æ—¶é—´ä¸º0è¡¨ç¤ºå°½å¿«æ‰§è¡Œå®šæ—¶å™¨æ˜¯å®ä»»åŠ¡ï¼Œäºæ˜¯æŠŠå®šæ—¶å™¨ä»»åŠ¡æ”¾å…¥å®ä»»åŠ¡é˜Ÿåˆ—ç°åœ¨å®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯ï¼ˆä¸»çº¿ï¼Œå®šæ—¶å™¨ï¼‰ æ¥ç€å¾€ä¸‹è§£æï¼Œå¼€å§‹æ‰§è¡Œpromiseçš„ä»£ç ï¼Œé‡åˆ°promiseé‡Œçš„2ç›´æ¥è¾“å‡º promiseä¸­æœ‰ä¸€ä¸ªå¼‚æ­¥æ–¹æ³•ï¼Œæ˜¯å¾®ä»»åŠ¡ï¼Œäºæ˜¯æŠŠä»–æ”¾åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— ç»§ç»­å¾€ä¸‹æ‰§è¡Œå…¨å±€ä»£ç ï¼Œè¾“å‡º4 è·‘å®Œä¸Šé¢çš„æµç¨‹ï¼Œjsä¸»çº¿ï¼ˆå…¨å±€ï¼‰ä»£ç æ‰§è¡Œå®Œæˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªå®ä»»åŠ¡æ‰§è¡Œå®Œæˆäº† æŒ‰ç…§äº‹ä»¶å¾ªç¯å›¾çš„æµç¨‹ï¼Œå¼€å§‹æ£€æŸ¥å¾®ä»»åŠ¡é˜Ÿåˆ—æ˜¯å¦æœ‰ä»»åŠ¡ï¼Œæœ‰çš„è¯æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œè¾“å‡º3 ç¬¬ä¸€è½®å¾ªç¯ç»“æŸï¼Œæ›´æ–°UIä¸»çº¿ï¼ˆå…¨å±€ï¼‰ä»»åŠ¡ä»å®ä»»åŠ¡ä¸­å‡ºé˜Ÿ å¼€å§‹æ–°çš„ä¸€è½®äº‹ä»¶å¾ªç¯ï¼Œæ‰§è¡Œé˜Ÿé¦–çš„å®ä»»åŠ¡å³ä¹‹å‰çš„å®šæ—¶å™¨ä»»åŠ¡è¾“å‡º1 é€šè¿‡ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“ï¼Œå®šæ—¶å™¨çš„æ‰§è¡Œæ—¶é—´æœºåˆ¶ï¼šå› ä¸ºjså•çº¿ç¨‹çš„æœ¬è´¨ï¼Œæˆ‘ä»¬åªèƒ½æ§åˆ¶å®šæ—¶å™¨ä½•æ—¶è¢«åŠ å…¥å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè€Œæ— æ³•æ§åˆ¶å…¶ä½•æ—¶æ‰§è¡Œ å†çœ‹ä¸€ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920212223242526272829303132333435363738//è¯·å†™å‡ºè¾“å‡ºå†…å®¹async function async1() &#123; console.log('async1 start'); await async2(); console.log('async1 end');&#125;async function async2() &#123; console.log('async2');&#125;console.log('script start');setTimeout(function() &#123; console.log('setTimeout');&#125;, 0)async1();new Promise(function(resolve) &#123; console.log('promise1'); resolve();&#125;).then(function() &#123; console.log('promise2');&#125;);console.log('script end');/*script startasync1 startasync2promise1script endasync1 endpromise2setTimeout*/ ä¸Šé¢è¿™ä¸ªä¾‹é¢˜å¯èƒ½ä¼šæœ‰ä¸€äº›åœ°æ–¹éš¾ç†è§£ï¼Œä¸»è¦æ˜¯asyncå’Œawait 12345async function async1() &#123; console.log('async1 start'); await async2(); console.log('async1 end');&#125; ç­‰ä»·äºï¼š 123456async function async1() &#123; console.log('async1 start'); Promise.resolve(async2()).then(() =&gt; &#123; console.log('async1 end'); &#125;)&#125; nodejsçš„äº‹ä»¶å¾ªç¯æœºåˆ¶","tags":[{"name":"nodejs","slug":"nodejs","permalink":"https://luckyjq.github.io/tags/nodejs/"},{"name":"js","slug":"js","permalink":"https://luckyjq.github.io/tags/js/"},{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"https://luckyjq.github.io/tags/åŸºç¡€/"}]},{"title":"ç†è§£typeofå’Œinstanceof","date":"2019-04-17T09:34:32.000Z","path":"2019/04/17/ç†è§£typeofå’Œinstanceof/","text":"ç†è§£typeofå’Œinstanceofï¼Œä»åŸå‹å¼€å§‹è¯´èµ· typeofåˆ¤æ–­ç±»å‹å­˜åœ¨çš„é—®é¢˜å¯¹äºè¿™ä¸¤ä¸ªjså…³é”®è¯ï¼Œä¸€ç›´åœç•™åœ¨å¾ˆæµ…æ˜¾çš„ç†è§£ä¸Šã€‚ç›´åˆ°æœ€è¿‘å¼€å§‹åˆ·ä¸ªå¤§å…¬å¸çš„é¢è¯•é¢˜ï¼Œå‘ç°è¿™ä¸€çŸ¥è¯†ç‚¹å‡ºåœºä¹‹é«˜ï¼Œå†³å¿ƒæ€»ç»“ä¸€ä¸‹ã€‚ typeofåˆ¤æ–­ç±»å‹ï¼Œæˆªå›¾æ¥è‡ªMDNã€‚é—®é¢˜å‡ºç°äº†ï¼Œå½“ç±»å‹ä¸ºNullå’ŒArrayå’ŒObjectæ—¶å€™ï¼Œå‡è¿”å›â€œobjectâ€ï¼Œå¦‚ä½•åŒºåˆ«ï¼Ÿ ä¸€ç§å¸¸ç”¨çš„æ£€æµ‹æ–¹æ³•æ˜¯ä½¿ç”¨ï¼šObject.prototype.toString.call(obj) 12var arr = [12,'aaa']Object.prototype.toString.call(arr) //\"[object Array]\" ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ObjectåŸå‹ä¸Šçš„toStringæ–¹æ³•ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ï¼Ÿå› ä¸ºArray ï¼Œfunctionç­‰ç±»å‹ä½œä¸ºObjectçš„å®ä¾‹ï¼Œéƒ½é‡å†™äº†toStringæ–¹æ³• 1arr.toString() //\"12,aaa\" ä½†æ˜¯ä½¿ç”¨ä¸Šé¢è¿™ç§æ–¹æ³•åˆ¤æ–­ä¹Ÿå­˜åœ¨å±€é™æ€§ï¼Œå¯¹äºä»»ä½•å¯¹è±¡ï¼Œè¿”å›éƒ½æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬ç°åœ¨çš„éœ€æ±‚æ˜¯æœ‰ä¸åŒæ„é€ å‡½æ•°æ¯”å¦‚Studentï¼ŒDogç­‰ç­‰ï¼Œæˆ‘ä»¬newä¸€ä¸ªå®ä¾‹çš„æ—¶å€™æƒ³åˆ¤æ–­è¿™ä¸ªå®ä¾‹æ˜¯ä¸€ä¸ªDogè¿˜æ˜¯ä¸€ä¸ªStudentï¼Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°instanceofã€‚ instanceofå¤§æ³•å¥½123456789var Student = function (name,age) &#123;this.name = namethis.age = age&#125;Student.prototype.say = function()&#123;console.log(`i am $&#123;name&#125;,and i am $&#123;age&#125; years old!`)&#125;var stu = new Student('Tom', 20)stu instanceof Student //true è¦ç†è§£instanceofè‚¯å®šé€ƒä¸è¿‡åŸå‹é“¾ï¼Œç¥­å‡ºåŸå‹é“¾å¤§å›¾ï¼ˆå¦‚æœè¿˜ä¸ç†è§£åŸå‹é“¾å¯ä»¥å‚è€ƒå…¶ä»–æ–‡ç« ï¼Œè¦æ±‚èƒ½æŠŠä¸‹é¢å›¾çœ‹æ‡‚ï¼‰ å…³é”®ç‚¹ï¼šé¦–å…ˆï¼Œjsä¸­ä¸€åˆ‡éƒ½æ˜¯å¯¹è±¡ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰prototypeå’Œprotoå±æ€§æ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰protoå±æ€§Object.prototypeæ˜¯æ‰€æœ‰å¯¹è±¡çš„æ ¹Function.prototypeæ˜¯æ‰€æœ‰å‡½æ•°çš„æ ¹Objectå’ŒFunctionéƒ½æ˜¯æ„é€ å‡½æ•° instanceofçš„åˆ¤æ–­åŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯åœ¨å®ä¾‹çš„protoé“¾æ¡ä¸Šå¯»æ‰¾ï¼Œå¦‚æœæœ‰å°±è¿”å›trueé€šè¿‡ä¸Šé¢çš„å›¾ä¹Ÿå¯ä»¥ç†è§£å‡ ä¸ªå¾ˆå¥‡æ€ªçš„instanceofåˆ¤æ–­ 1234Function instanceof Function //trueObject instanceof Function //trueObject instanceof Object //trueFunction instanceof Object //true è¡¥å……è¿™ä¸¤å¤©çœ‹ä¹¦ï¼Œå‘ç°è‡ªå·±å¯¹instanceofçš„ä½¿ç”¨æœ‰ä¸ªåœ°æ–¹è¿˜æ˜¯ä¸æ¸…æ¥š 12345function Person()&#123;&#125;Person.prototype.dance = function()&#123;&#125;function Ninja()&#123;&#125;Ninja.prototype = new Person()const ninja = new Ninja() ä¸€èˆ¬çš„jsç»§æ‰¿å†™æ³•ï¼Œä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯ï¼šNinja.prototypeè¢«æ”¹å†™æˆä¸€ä¸ªPersonå®ä¾‹å¯¹è±¡äº†æ‰€ä»¥:ninja instanceof Ninjaè¿”å›falseï¼Œninja instanceof Person è¿”å›true ä½†æ˜¯æµ‹è¯•è¿”å›çš„æ˜¯ä¸¤ä¸ªtrue åˆ°åº•è¯¥å¦‚ä½•ç†è§£instanceof?æ£€æŸ¥å³è¾¹çš„å‡½æ•°åŸå‹æ˜¯å¦å­˜åœ¨äºæ“ä½œç¬¦å·¦è¾¹çš„å¯¹è±¡çš„åŸå‹é“¾ä¸ŠNinja.prototype æ˜¯å¦åœ¨ninjaå¯¹è±¡çš„protoé“¾ä¸Š å½“ä½ å®ä¾‹åŒ–æ—¶å€™ï¼Œconst ninja = new Ninja()åˆ¤æ–­ninja instanceof Ninjaæ—¶ï¼Œå°±çœ‹Ninja.prototypeæ˜¯å¦åœ¨ninjaå®ä¾‹çš„protoé“¾æ¡ä¸Šè€ŒNinja.prototypeæ˜¯new Personï¼Œåœ¨ninjaå®ä¾‹çš„protoé“¾æ¡ä¸Šï¼Œæ‰€ä»¥å°±è¿”å›trueè¿™æ ·æ‰æ˜¯æ­£ç¡®ç†è§£instanceofçš„æ–¹å¼","tags":[{"name":"js","slug":"js","permalink":"https://luckyjq.github.io/tags/js/"},{"name":"åŸºç¡€","slug":"åŸºç¡€","permalink":"https://luckyjq.github.io/tags/åŸºç¡€/"}]}]